import { beforeAll, describe, expect, it } from 'vitest';

import {
  buildSegmentTree,
  queryRange,
  buildSegTreeIterative,
  iterativeQueryRange,
  updateLeafNode,
  updateLeafNodeIterative,
  SegmentTree,
  updateRangeLazy
} from '../../../src/data-structures/segment-tree/segmentTree'
import {
  baseSegmentTreeNode,
  segmentTreeNodeMerger,
  segmentTreeRangeNodeUpdater,
  segmentTreeRangeNodePropagator
} from '../../../src/data-structures/segment-tree/interfaces'
import {
  nodeFactoryFnL,
  singleLazyNodeUpdate,
  nodeMergerFnL,
  nodeSegLazyRangeUpdater,
  lazyValuePropagator,
  nodeQueryMergerL,
  segmentLazy
} from '../../../src/data-structures/segment-tree/lazyMaxAndSumSegmentTree'

import {
  finNodeFactory,
  finNodeLeafUpdater,
  finNodeMerger,
  finNodeQuery
} from '../../../src/examples/data-structures/segment-tree/meanVarianceSegmentTree'
import { SegmentTree as NewSegmentTree } from '../../../src/data-structures/segment-tree';
import { SegmentTreeIterator } from '../../../src/data-structures/segment-tree/iterator';
import { ICollection } from '../../../src/core/interfaces/ICollection';
import { IDataStructure } from '../../../src/core/interfaces/IDataStructure';
import { IIterator } from '../../../src/core/interfaces/IIterator';

interface segmentNode extends baseSegmentTreeNode {
  min: number
  max: number
  sum: number
  minIdx: number
  maxIdx: number
}

const nodeFactoryFn = (val: number, l: number, r: number): segmentNode => {
  let node: segmentNode = {
    left: l,
    right: r,
    leftChild: null,
    rightChild: null,
    min: Number.MAX_VALUE,
    max: -Number.MAX_VALUE,
    sum: 0,
    minIdx: -1,
    maxIdx: -1
  }

  if (r - l == 0) {
    node.min = val
    node.max = val
    node.maxIdx = l
    node.minIdx = l
    node.sum = val
  }

  return node
}

/**@TODO this can be  used for querying too, just create the parent locally...
 * and btw theres no need of parent as the left and right info can be taken from left anr right child */
const nodeMergerFn = (
  parent: segmentNode,
  leftChild: segmentNode,
  rightChild: segmentNode
): segmentNode => {
  parent.max = Math.max(leftChild.max, rightChild.max)
  parent.min = Math.min(leftChild.min, rightChild.min)
  parent.max == leftChild.max
    ? (parent.maxIdx = leftChild.maxIdx)
    : (parent.maxIdx = rightChild.maxIdx)
  parent.min == leftChild.min
    ? (parent.minIdx = leftChild.minIdx)
    : (parent.minIdx = rightChild.minIdx)
  parent.sum = leftChild.sum + rightChild.sum
  return parent
}

const nodeSegLeafUpdater = (t: number, leaf: segmentNode): void => {
  leaf.max = leaf.min = leaf.sum = t
}

const nodeQueryMerger = (leftNode: segmentNode, rightNode: segmentNode) => {
  if (leftNode.left == -1) return rightNode
  if (rightNode.left == -1) return leftNode
  let mergedNode: segmentNode = {
    left: leftNode.left,
    right: rightNode.right,
    leftChild: null,
    rightChild: null,
    min: Number.MAX_VALUE,
    max: -Number.MAX_VALUE,
    sum: leftNode.sum + rightNode.sum,
    minIdx: -1,
    maxIdx: -1
  }
  ;[mergedNode.minIdx, mergedNode.min] =
    leftNode.min < rightNode.min
      ? [leftNode.minIdx, leftNode.min]
      : [rightNode.minIdx, rightNode.min]
  ;[mergedNode.maxIdx, mergedNode.max] =
    leftNode.max > rightNode.max
      ? [leftNode.maxIdx, leftNode.max]
      : [rightNode.maxIdx, rightNode.max]

  return mergedNode
}

describe('testing segmentTree setup query and update: ', () => {
  let testArr: Array<number> = [3, 45, 6, 7, 8, 23, 1, 2, 55, 6, 7, 85, 34, 6, 12, 66]
  const SEGMENT: segmentNode[] = buildSegmentTree(testArr, nodeFactoryFn, nodeMergerFn)
  const SEG_ITER: segmentNode[] = buildSegTreeIterative(testArr, nodeFactoryFn, nodeMergerFn)
  it('builds a segmentTree from a small array:', () => {
    SEGMENT.forEach((node, idx) => {
      if (idx > 0) {
        expect(node.left).not.toEqual(-1)
        expect(node.right).not.toEqual(-1)
        // expect(node.right).toBeGreaterThanOrEqual(node.left);
        expect(node.min).not.toEqual(Number.MAX_VALUE)
        expect(node.max).not.toEqual(-Number.MAX_VALUE)
      }
    })
  })

  /**@TODO test by comparing iterative and recoursive creation of trees in different cases */
  it('compares iterative and recursive creation of trees in different cases', () => {
    const compareTrees = (arr: number[]) => {
      const recTree = buildSegmentTree(arr, nodeFactoryFn, nodeMergerFn)
      const iterTree = buildSegTreeIterative(arr, nodeFactoryFn, nodeMergerFn)

      for (let i = 0; i < arr.length; i++) {
        for (let j = i; j < arr.length; j++) {
          const recRes = queryRange(recTree, 1, i, j, nodeQueryMerger)
          const iterRes = iterativeQueryRange(iterTree, i, j, nodeQueryMerger)

          expect(iterRes.min).toEqual(recRes.min)
          expect(iterRes.max).toEqual(recRes.max)
          expect(iterRes.sum).toEqual(recRes.sum)
        }
      }
    }

    // Case 1: Existing testArr (length 16, power of 2)
    compareTrees(testArr)

    // Case 2: Odd length array
    compareTrees([1, 5, 2, 8, 3])

    // Case 3: Random array
    const randomArr = Array.from({ length: 20 }, () => Math.floor(Math.random() * 100))
    compareTrees(randomArr)

    // Case 4: Single element
    compareTrees([42])
  })

  it('queries a range: ', () => {
    let res = queryRange(SEGMENT, 1, 4, 7, nodeQueryMerger)
    expect(res.sum).toEqual(34)
    expect(res.max).toEqual(23)
    expect(res.min).toEqual(1)
    expect(res.minIdx).toEqual(6)
    expect(res.maxIdx).toEqual(5)
  })

  it('queries a range in iterative tree by recoursive call: ', () => {
    let res = queryRange(SEG_ITER, 1, 4, 7, nodeQueryMerger)
    expect(res.sum).toEqual(34)
    expect(res.max).toEqual(23)
    expect(res.min).toEqual(1)
    expect(res.minIdx).toEqual(6)
    expect(res.maxIdx).toEqual(5)
  })

  it('queries a range in iterative tree by iterative call: ', () => {
    let res = iterativeQueryRange(SEG_ITER, 4, 7, nodeQueryMerger)

    expect(res.sum).toEqual(34)
    expect(res.max).toEqual(23)
    expect(res.min).toEqual(1)
    expect(res.minIdx).toEqual(6)
    expect(res.maxIdx).toEqual(5)
  })

  let testArr19: Array<number> = [3, 45, 6, 7, 8, 23, 1, 2, 55, 6, 7, 85, 34, 6, 12, 66, 34, 22, 8]

  const SEG_ITER19: segmentNode[] = buildSegTreeIterative(testArr19, nodeFactoryFn, nodeMergerFn)
  it('creates segment tree of 19 length source: ', () => {
    SEG_ITER19.forEach((node, idx) => {
      if (idx > 0) {
        expect(node.left).not.toEqual(-1)
        expect(node.right).not.toEqual(-1)
        //expect(node.right).toBeGreaterThanOrEqual(node.left);
        expect(node.min).not.toEqual(Number.MAX_VALUE)
        expect(node.max).not.toEqual(-Number.MAX_VALUE)
      }
    })
  })

  it('queries a range in iterative tree by recoursive call: tree from 19 length source ', () => {
    let res = iterativeQueryRange(SEG_ITER19, 4, 7, nodeQueryMerger)
    expect(res.sum).toEqual(34)
    expect(res.max).toEqual(23)
    expect(res.min).toEqual(1)
    expect(res.minIdx).toEqual(6)
    expect(res.maxIdx).toEqual(5)
  })

  it('queries from beginning: tree from 19 length source ', () => {
    let res = iterativeQueryRange(SEG_ITER19, 0, 7, nodeQueryMerger)
    let resOld = iterativeQueryRange(SEG_ITER, 0, 7, nodeQueryMerger)
    let resRec = queryRange(SEGMENT, 1, 0, 7, nodeQueryMerger)

    expect(res).toEqual(resOld)
    expect(res).toEqual(resRec)
  })

  it('updates a leaf in recoursive tree reducing the maximum in that interval', () => {
    updateLeafNode(SEGMENT, 20, 5, nodeSegLeafUpdater, nodeMergerFn)
    let res = queryRange(SEGMENT, 1, 4, 7, nodeQueryMerger)
    expect(res.sum).toEqual(31)
    expect(res.max).toEqual(20)
    expect(res.min).toEqual(1)
    expect(res.minIdx).toEqual(6)
    expect(res.maxIdx).toEqual(5)
  })

  it('updates a leaf in iterative built tree reducing the maximum in that interval', () => {
    updateLeafNodeIterative(SEG_ITER, 20, 5, nodeSegLeafUpdater, nodeMergerFn)
    let res = queryRange(SEG_ITER, 1, 4, 7, nodeQueryMerger)
    expect(res.sum).toEqual(31)
    expect(res.max).toEqual(20)
    expect(res.min).toEqual(1)
    expect(res.minIdx).toEqual(6)
    expect(res.maxIdx).toEqual(5)
  })

  it('modifies place in query range for tree19 too and check queries are the same on all trees ', () => {
    updateLeafNodeIterative(SEG_ITER19, 20, 5, nodeSegLeafUpdater, nodeMergerFn)
    let res = iterativeQueryRange(SEG_ITER19, 0, 7, nodeQueryMerger)
    let resOld = iterativeQueryRange(SEG_ITER, 0, 7, nodeQueryMerger)
    let resRec = queryRange(SEGMENT, 1, 0, 7, nodeQueryMerger)

    expect(res).toEqual(resOld)
    expect(res).toEqual(resRec)
  })

  it('creates new minimum and new maximum then queries whole tree ', () => {
    let resWholePrev = iterativeQueryRange(SEG_ITER19, 0, 18, nodeQueryMerger)
    updateLeafNodeIterative(SEG_ITER19, 0, 18, nodeSegLeafUpdater, nodeMergerFn)
    updateLeafNodeIterative(SEG_ITER19, 100, 1, nodeSegLeafUpdater, nodeMergerFn)
    let resWhole = iterativeQueryRange(SEG_ITER19, 0, 18, nodeQueryMerger)
    let resLeftBranch = iterativeQueryRange(SEG_ITER19, 0, 8, nodeQueryMerger)
    let resRightBranch = iterativeQueryRange(SEG_ITER19, 9, 18, nodeQueryMerger)
    let leftSum = 0
    let rightSum = 0

    for (let i = 0; i < 9; i++) {
      leftSum += testArr19[i]
    }
    for (let i = 9; i < 19; i++) {
      rightSum += testArr19[i]
    }
    expect(resWhole.max).toEqual(100)
    expect(resWhole.min).toEqual(0)
    expect(resWhole.sum).toEqual(47 + resWholePrev.sum)

    expect(resLeftBranch.max).toEqual(100)
    expect(resLeftBranch.min).toEqual(1)
    expect(resLeftBranch.sum).toEqual(leftSum + 52)

    expect(resRightBranch.max).toEqual(85)
    expect(resRightBranch.min).toEqual(0)
    expect(resRightBranch.sum).toEqual(rightSum - 8)
  })

  it('test performance', () => {
    /**create array of 10000000
     * test time of building segment tree
     * test time of querying against linear query
     */
    const rangeMinMaxSum = (arr: number[], start: number, end: number) => {
      let min = arr[start]
      let max = arr[start]
      let sum = 0
      for (let s = start; s <= end; s++) {
        sum += arr[s]
        min = Math.min(arr[s], min)
        max = Math.max(arr[s], max)
      }
      return {
        sum: sum,
        min: min,
        max: max
      }
    }
    let longArray = []

    for (let i = 0; i < 500000; i++) longArray.push(i + 1)

    console.time('build')
    const SEG_LONG: segmentNode[] = buildSegTreeIterative(longArray, nodeFactoryFn, nodeMergerFn)
    console.timeEnd('build')

    console.time('query')
    let res = iterativeQueryRange(SEG_LONG, 2300, 400000, nodeQueryMerger)
    console.timeEnd('query')
    console.time('queryiter')
    let ires = rangeMinMaxSum(longArray, 2300, 400000)
    console.timeEnd('queryiter')
    expect(res.sum).toEqual(ires.sum)
    expect(res.min).toEqual(ires.min)
    expect(res.max).toEqual(ires.max)
  })
})

const financialSeries = [
  ['2016-01-03T23:00:00.000Z', 25.82, 25.97, 25.26, 25.79, 25.09, 225],
  ['2016-01-04T23:00:00.000Z', 25.92, 25.92, 25.22, 25.43, 24.74, 117],
  ['2016-01-05T23:00:00.000Z', 25.11, 25.22, 24.56, 24.66, 23.99, 177],
  ['2016-01-06T23:00:00.000Z', 24.21, 24.69, 24.1, 24.1, 23.45, 206],
  ['2016-01-07T23:00:00.000Z', 24.2, 24.2, 23.47, 23.51, 22.87, 297],
  ['2016-01-10T23:00:00.000Z', 23.6, 23.78, 23.06, 23.36, 22.73, 189],
  ['2016-01-11T23:00:00.000Z', 23.52, 23.79, 23.11, 23.76, 23.12, 331],
  ['2016-01-12T23:00:00.000Z', 23.76, 23.91, 23.01, 23.12, 22.5, 308],
  ['2016-01-13T23:00:00.000Z', 23.17, 23.91, 22.7, 23.66, 23.02, 259],
  ['2016-01-14T23:00:00.000Z', 23.09, 23.97, 22.99, 23.87, 23.22, 350],
  ['2016-01-18T23:00:00.000Z', 24.02, 24.09, 21.42, 21.88, 21.29, 350],
  ['2016-01-19T23:00:00.000Z', 21.56, 22.16, 20.29, 21.99, 21.4, 303],
  ['2016-01-20T23:00:00.000Z', 22.05, 22.31, 21.69, 21.75, 21.16, 192],
  ['2016-01-21T23:00:00.000Z', 22.08, 22.42, 21.58, 21.89, 21.3, 187],
  ['2016-01-24T23:00:00.000Z', 21.76, 21.77, 21, 21.03, 20.46, 158],
  ['2016-01-25T23:00:00.000Z', 21.09, 21.39, 20.87, 21.1, 20.6, 198],
  ['2016-01-26T23:00:00.000Z', 20.95, 21.11, 20.53, 20.66, 20.17, 144],
  ['2016-01-27T23:00:00.000Z', 20.81, 21.03, 20.16, 20.25, 19.77, 173],
  ['2016-01-28T23:00:00.000Z', 20.32, 21.02, 20.19, 21.01, 20.52, 389],
  ['2016-01-31T23:00:00.000Z', 20.88, 20.88, 20.22, 20.69, 20.2, 166],
  ['2016-02-01T23:00:00.000Z', 20.4, 20.57, 19.34, 19.36, 18.9, 174],
  ['2016-02-02T23:00:00.000Z', 19.54, 19.76, 18.91, 19.67, 19.21, 189],
  ['2016-02-03T23:00:00.000Z', 19.63, 20.64, 19.6, 20.05, 19.58, 115],
  ['2016-02-04T23:00:00.000Z', 19.96, 19.98, 19.26, 19.3, 18.85, 152],
  ['2016-02-07T23:00:00.000Z', 19.1, 19.48, 18.7, 19.4, 18.94, 177],
  ['2016-02-08T23:00:00.000Z', 19.2, 19.79, 19.01, 19.63, 19.17, 213],
  ['2016-02-09T23:00:00.000Z', 19.72, 20.2, 19.44, 19.79, 19.32, 247],
  ['2016-02-10T23:00:00.000Z', 19.41, 19.41, 18.36, 18.98, 18.53, 163],
  ['2016-02-11T23:00:00.000Z', 19.13, 19.14, 18.76, 18.93, 18.48, 170],
  ['2016-02-15T23:00:00.000Z', 19.16, 19.74, 19.01, 19.62, 19.16, 189],
  ['2016-02-16T23:00:00.000Z', 19.79, 19.99, 19.45, 19.56, 19.1, 214],
  ['2016-02-17T23:00:00.000Z', 19.63, 20.34, 19.47, 19.74, 19.28, 215],
  ['2016-02-18T23:00:00.000Z', 19.7, 19.9, 19.41, 19.56, 19.1, 239],
  ['2016-02-21T23:00:00.000Z', 19.97, 21.9, 19.97, 21.23, 20.73, 348],
  ['2016-02-22T23:00:00.000Z', 21.13, 21.41, 20.91, 20.99, 20.5, 199],
  ['2016-02-23T23:00:00.000Z', 20.77, 21.46, 20.56, 21.34, 20.84, 162],
  ['2016-02-24T23:00:00.000Z', 21.45, 21.56, 21.17, 21.52, 21.01, 142],
  ['2016-02-25T23:00:00.000Z', 21.59, 21.94, 21.4, 21.6, 21.09, 162],
  ['2016-03-06T23:00:00.000Z', 22.1, 22.59, 21.79, 22.36, 21.83, 276],
  ['2016-03-07T23:00:00.000Z', 22.18, 22.18, 21.17, 21.45, 20.94, 217],
  ['2016-03-08T23:00:00.000Z', 21.52, 21.98, 21.35, 21.79, 21.28, 199],
  ['2016-03-09T23:00:00.000Z', 21.8, 21.95, 20.8, 21.26, 20.76, 242],
  ['2016-03-10T23:00:00.000Z', 21.41, 21.68, 20.95, 21.61, 21.1, 255],
  ['2016-03-13T23:00:00.000Z', 21.47, 21.54, 21.22, 21.29, 20.79, 168],
  ['2016-03-14T23:00:00.000Z', 21.06, 21.1, 20.74, 21, 20.51, 150],
  ['2016-03-15T23:00:00.000Z', 21, 21.35, 20.96, 21.21, 20.71, 125],
  ['2016-03-16T23:00:00.000Z', 21.15, 22.14, 21.02, 22.07, 21.55, 209],
  ['2016-03-17T23:00:00.000Z', 22.2, 22.68, 21.93, 22.63, 22.1, 350],
  ['2016-03-20T23:00:00.000Z', 22.52, 22.72, 22.04, 22.21, 21.69, 264],
  ['2016-03-21T23:00:00.000Z', 22.02, 22.24, 21.71, 21.94, 21.42, 205],
  ['2016-03-22T23:00:00.000Z', 21.06, 24.3, 20.95, 23.03, 22.49, 697],
  ['2016-03-23T23:00:00.000Z', 22.82, 22.83, 21.45, 22.8, 22.26, 474],
  ['2016-03-27T22:00:00.000Z', 22.93, 23, 22.44, 22.62, 22.09, 338],
  ['2016-03-28T22:00:00.000Z', 22.49, 23.22, 22.23, 23.21, 22.66, 338],
  ['2016-03-29T22:00:00.000Z', 23.35, 23.38, 22.96, 23.2, 22.65, 313],
  ['2016-03-30T22:00:00.000Z', 23.2, 23.47, 23.08, 23.27, 22.72, 240],
  ['2016-03-31T22:00:00.000Z', 23.15, 23.61, 22.92, 23.39, 22.84, 198],
  ['2016-04-03T22:00:00.000Z', 23.36, 23.63, 23.21, 23.29, 22.74, 194],
  ['2016-04-04T22:00:00.000Z', 23.17, 23.51, 22.99, 23.25, 22.7, 241],
  ['2016-04-05T22:00:00.000Z', 23.36, 23.42, 22.98, 23.27, 22.72, 162],
  ['2016-04-06T22:00:00.000Z', 23.07, 23.49, 23.06, 23.3, 22.75, 465],
  ['2016-04-07T22:00:00.000Z', 23.48, 23.94, 23.28, 23.44, 22.89, 149],
  ['2016-04-10T22:00:00.000Z', 23.54, 23.82, 23.32, 23.32, 22.77, 149],
  ['2016-04-11T22:00:00.000Z', 23.3, 23.85, 23.27, 23.53, 22.98, 78],
  ['2016-04-12T22:00:00.000Z', 23.64, 24.23, 23.52, 24.15, 23.58, 307],
  ['2016-04-13T22:00:00.000Z', 24.16, 24.74, 24.13, 24.61, 24.03, 270],
  ['2016-04-14T22:00:00.000Z', 24.62, 24.8, 24.12, 24.13, 23.56, 139],
  ['2016-04-17T22:00:00.000Z', 24.08, 24.53, 24.06, 24.21, 23.64, 122],
  ['2016-04-18T22:00:00.000Z', 24.26, 24.66, 24.12, 24.29, 23.72, 107],
  ['2016-04-19T22:00:00.000Z', 24.19, 24.61, 24.04, 24.43, 23.85, 155],
  ['2016-04-20T22:00:00.000Z', 24.43, 24.51, 23.86, 24.04, 23.47, 134],
  ['2016-04-21T22:00:00.000Z', 23.99, 24.42, 23.94, 24.19, 23.62, 120],
  ['2016-04-24T22:00:00.000Z', 24.13, 24.33, 23.48, 23.61, 23.05, 141],
  ['2016-04-25T22:00:00.000Z', 23.76, 24.44, 23.46, 24.43, 23.85, 173],
  ['2016-04-26T22:00:00.000Z', 24.43, 24.6, 24.21, 24.44, 23.94, 131],
  ['2016-04-27T22:00:00.000Z', 24.33, 24.85, 24.16, 24.22, 23.72, 178],
  ['2016-04-28T22:00:00.000Z', 24.2, 24.47, 23.88, 24.04, 23.55, 143],
  ['2016-05-01T22:00:00.000Z', 24.11, 24.13, 23.73, 24.06, 23.57, 123],
  ['2016-05-02T22:00:00.000Z', 23.91, 24.09, 23.46, 23.83, 23.34, 143],
  ['2016-05-03T22:00:00.000Z', 23.58, 23.83, 23.3, 23.51, 23.03, 145],
  ['2016-05-04T22:00:00.000Z', 23.67, 23.85, 23.45, 23.57, 23.09, 88],
  ['2016-05-05T22:00:00.000Z', 23.52, 23.89, 23.48, 23.85, 23.36, 107],
  ['2016-05-08T22:00:00.000Z', 23.72, 24.15, 23.62, 23.81, 23.32, 102],
  ['2016-05-09T22:00:00.000Z', 24, 24.61, 24, 24.55, 24.05, 72],
  ['2016-05-10T22:00:00.000Z', 24.56, 24.66, 23.92, 23.95, 23.46, 82],
  ['2016-05-11T22:00:00.000Z', 23.93, 24.03, 23.5, 23.77, 23.28, 91],
  ['2016-05-12T22:00:00.000Z', 23.61, 23.91, 23.35, 23.37, 22.89, 99],
  ['2016-05-15T22:00:00.000Z', 23.49, 24.48, 23.45, 24.34, 23.84, 154],
  ['2016-05-16T22:00:00.000Z', 24.27, 24.4, 23.22, 23.33, 22.85, 151],
  ['2016-05-17T22:00:00.000Z', 23.24, 23.74, 23, 23.41, 22.93, 92],
  ['2016-05-18T22:00:00.000Z', 23.21, 23.43, 22.59, 23.01, 22.54, 105],
  ['2016-05-19T22:00:00.000Z', 23.04, 23.68, 22.92, 23.67, 23.18, 122],
  ['2016-05-22T22:00:00.000Z', 23.68, 23.73, 23.01, 23.28, 22.8, 191],
  ['2016-05-23T22:00:00.000Z', 23.44, 24.2, 23.44, 24.1, 23.61, 156],
  ['2016-05-24T22:00:00.000Z', 24.23, 24.36, 24.1, 24.24, 23.74, 85],
  ['2016-05-25T22:00:00.000Z', 24.24, 24.57, 24, 24.47, 23.97, 119],
  ['2016-05-26T22:00:00.000Z', 24.41, 24.65, 24.24, 24.53, 24.03, 104],
  ['2016-05-30T22:00:00.000Z', 24.52, 24.66, 24.31, 24.41, 23.91, 106],
  ['2016-05-31T22:00:00.000Z', 24.3, 24.58, 24, 24.39, 23.89, 223],
  ['2016-06-01T22:00:00.000Z', 24.33, 24.61, 24.29, 24.6, 24.09, 113],
  ['2016-06-02T22:00:00.000Z', 24.56, 24.67, 24.13, 24.29, 23.79, 178],
  ['2016-06-05T22:00:00.000Z', 24.25, 24.87, 24.21, 24.81, 24.3, 122],
  ['2016-06-06T22:00:00.000Z', 24.81, 24.89, 24.56, 24.58, 24.08, 78],
  ['2016-06-07T22:00:00.000Z', 24.57, 24.68, 24.31, 24.41, 23.91, 134],
  ['2016-06-08T22:00:00.000Z', 24.33, 24.37, 24.14, 24.27, 23.77, 148],
  ['2016-06-09T22:00:00.000Z', 24.07, 24.27, 23.77, 24.19, 23.69, 104],
  ['2016-06-12T22:00:00.000Z', 24.13, 24.13, 23.29, 23.36, 22.88, 122],
  ['2016-06-13T22:00:00.000Z', 23.32, 23.4, 22.85, 23.12, 22.65, 105],
  ['2016-06-14T22:00:00.000Z', 23.2, 23.38, 23.02, 23.03, 22.56, 199],
  ['2016-06-15T22:00:00.000Z', 22.86, 22.86, 22.27, 22.52, 22.06, 141],
  ['2016-06-16T22:00:00.000Z', 22.47, 23.27, 22.47, 23.2, 22.72, 285],
  ['2016-06-19T22:00:00.000Z', 23.52, 23.73, 23.22, 23.24, 22.76, 131],
  ['2016-06-20T22:00:00.000Z', 23.37, 23.37, 23.06, 23.15, 22.67, 88],
  ['2016-06-21T22:00:00.000Z', 23.25, 23.32, 22.89, 22.9, 22.43, 89],
  ['2016-06-22T22:00:00.000Z', 23.23, 23.77, 23.23, 23.5, 23.02, 303],
  ['2016-06-23T22:00:00.000Z', 22.65, 23.33, 22.38, 23.24, 22.76, 409],
  ['2016-06-26T22:00:00.000Z', 22.87, 22.87, 21.94, 22.28, 21.82, 245],
  ['2016-06-27T22:00:00.000Z', 22.61, 22.61, 21.78, 22.06, 21.61, 203],
  ['2016-06-28T22:00:00.000Z', 22.32, 22.46, 22.18, 22.33, 21.87, 148],
  ['2016-06-29T22:00:00.000Z', 22.32, 23.36, 22.27, 23.34, 22.86, 264],
  ['2016-06-30T22:00:00.000Z', 23.28, 23.75, 23.22, 23.29, 22.81, 78],
  ['2016-07-04T22:00:00.000Z', 23.2, 23.22, 22.43, 22.62, 22.16, 74],
  ['2016-07-05T22:00:00.000Z', 22.57, 22.92, 22.37, 22.87, 22.4, 114],
  ['2016-07-06T22:00:00.000Z', 22.98, 23.15, 22.5, 22.72, 22.25, 79],
  ['2016-07-07T22:00:00.000Z', 22.97, 23.47, 22.8, 23.32, 22.84, 207],
  ['2016-07-10T22:00:00.000Z', 23.63, 24.05, 23.63, 24, 23.51, 161],
  ['2016-07-11T22:00:00.000Z', 24.2, 25.28, 24.2, 25.04, 24.53, 425],
  ['2016-07-12T22:00:00.000Z', 21.99, 23.77, 21.99, 22.73, 22.26, 1],
  ['2016-07-13T22:00:00.000Z', 22.77, 23.1, 22.1, 22.99, 22.52, 753],
  ['2016-07-14T22:00:00.000Z', 23.21, 23.43, 22.87, 23.33, 22.85, 331],
  ['2016-07-17T22:00:00.000Z', 23.24, 24.31, 23.16, 24.26, 23.76, 425],
  ['2016-07-18T22:00:00.000Z', 24.17, 24.47, 24.17, 24.21, 23.71, 280],
  ['2016-07-19T22:00:00.000Z', 24.15, 24.38, 23.9, 24.12, 23.7, 140],
  ['2016-07-20T22:00:00.000Z', 24.03, 24.52, 23.93, 24.25, 23.83, 183],
  ['2016-07-21T22:00:00.000Z', 24.18, 24.31, 23.87, 24.27, 23.85, 138],
  ['2016-07-24T22:00:00.000Z', 24.26, 24.4, 24, 24.21, 23.79, 244],
  ['2016-08-03T22:00:00.000Z', 23.93, 24.25, 23.92, 23.92, 23.5, 97],
  ['2016-08-04T22:00:00.000Z', 24.04, 24.69, 23.94, 24.39, 23.96, 141],
  ['2016-08-07T22:00:00.000Z', 24.36, 24.54, 24.03, 24.24, 23.82, 124],
  ['2016-08-08T22:00:00.000Z', 24.3, 24.35, 23.83, 24.02, 23.6, 124],
  ['2016-08-09T22:00:00.000Z', 24.14, 24.33, 23.65, 23.67, 23.26, 82],
  ['2016-08-10T22:00:00.000Z', 23.75, 23.8, 23.64, 23.68, 23.27, 183],
  ['2016-08-11T22:00:00.000Z', 23.7, 23.84, 23.6, 23.65, 23.24, 114],
  ['2016-08-14T22:00:00.000Z', 23.74, 24.07, 23.7, 24, 23.58, 131],
  ['2016-08-15T22:00:00.000Z', 23.9, 23.9, 23.5, 23.52, 23.11, 93],
  ['2016-08-16T22:00:00.000Z', 23.53, 23.63, 23.37, 23.48, 23.07, 110],
  ['2016-08-17T22:00:00.000Z', 23.42, 23.9, 23.34, 23.77, 23.35, 160],
  ['2016-08-18T22:00:00.000Z', 23.75, 23.92, 23.67, 23.88, 23.46, 224],
  ['2016-08-21T22:00:00.000Z', 23.81, 23.86, 23.5, 23.73, 23.31, 214],
  ['2016-08-22T22:00:00.000Z', 23.84, 24.66, 23.84, 24.65, 24.22, 140],
  ['2016-08-23T22:00:00.000Z', 24.62, 24.81, 24.29, 24.72, 24.29, 185],
  ['2016-08-24T22:00:00.000Z', 24.58, 24.9, 24.51, 24.8, 24.37, 127],
  ['2016-08-25T22:00:00.000Z', 24.83, 24.99, 24.27, 24.44, 24.01, 81],
  ['2016-08-28T22:00:00.000Z', 24.45, 24.81, 24.39, 24.6, 24.17, 59],
  ['2016-08-29T22:00:00.000Z', 24.69, 24.87, 24.56, 24.65, 24.22, 55],
  ['2016-08-30T22:00:00.000Z', 24.64, 24.79, 24.25, 24.61, 24.18, 122],
  ['2016-08-31T22:00:00.000Z', 24.6, 26.21, 24.26, 26.21, 25.75, 518],
  ['2016-09-01T22:00:00.000Z', 26.57, 29.08, 26.51, 29.03, 28.52, 1],
  ['2016-09-05T22:00:00.000Z', 29.01, 29.01, 28.07, 28.56, 28.06, 321],
  ['2016-09-06T22:00:00.000Z', 28.53, 28.62, 28.13, 28.59, 28.09, 184],
  ['2016-09-07T22:00:00.000Z', 28.59, 28.68, 28.29, 28.6, 28.1, 130],
  ['2016-09-08T22:00:00.000Z', 28.31, 28.36, 27.72, 27.73, 27.24, 165],
  ['2016-09-11T22:00:00.000Z', 27.51, 28.1, 27.43, 28.07, 27.58, 200],
  ['2016-09-12T22:00:00.000Z', 27.84, 28.05, 27.34, 27.46, 26.98, 168],
  ['2016-09-13T22:00:00.000Z', 27.51, 27.72, 27.06, 27.53, 27.05, 139],
  ['2016-09-14T22:00:00.000Z', 27.47, 28.06, 27.41, 28.06, 27.57, 145],
  ['2016-09-15T22:00:00.000Z', 28.08, 28.15, 27.36, 27.5, 27.02, 406],
  ['2016-09-18T22:00:00.000Z', 27.61, 28.11, 27.6, 27.73, 27.24, 141],
  ['2016-09-19T22:00:00.000Z', 27.84, 27.88, 27.42, 27.54, 27.06, 98],
  ['2016-09-20T22:00:00.000Z', 27.74, 28.06, 27.59, 28.03, 27.54, 133],
  ['2016-09-21T22:00:00.000Z', 28.3, 29.21, 28.25, 29.01, 28.5, 308],
  ['2016-09-22T22:00:00.000Z', 30, 31.23, 29.24, 29.66, 29.14, 665],
  ['2016-09-25T22:00:00.000Z', 29.54, 29.66, 28.96, 29.03, 28.52, 401],
  ['2016-09-26T22:00:00.000Z', 29.2, 29.52, 29.11, 29.34, 28.83, 296],
  ['2016-09-27T22:00:00.000Z', 29.45, 29.91, 29.26, 29.79, 29.27, 241],
  ['2016-09-28T22:00:00.000Z', 29.81, 30.24, 29.75, 30, 29.48, 202],
  ['2016-09-29T22:00:00.000Z', 30.1, 31.67, 30.1, 31.32, 30.77, 625],
  ['2016-10-02T22:00:00.000Z', 31.18, 31.3, 30.54, 30.95, 30.41, 309],
  ['2016-10-03T22:00:00.000Z', 31, 31.48, 30.76, 31.31, 30.76, 296],
  ['2016-10-04T22:00:00.000Z', 31.48, 31.77, 31.28, 31.69, 31.14, 334],
  ['2016-10-05T22:00:00.000Z', 31.71, 32.15, 31.45, 31.99, 31.43, 358],
  ['2016-10-06T22:00:00.000Z', 32.05, 32.05, 31.11, 31.43, 30.88, 300],
  ['2016-10-09T22:00:00.000Z', 31.75, 31.87, 31.25, 31.39, 30.84, 240],
  ['2016-10-10T22:00:00.000Z', 31.42, 31.57, 30.84, 31.12, 30.58, 238],
  ['2016-10-11T22:00:00.000Z', 31.24, 31.71, 31.04, 31.5, 30.95, 184],
  ['2016-10-12T22:00:00.000Z', 31.2, 31.29, 30.71, 30.96, 30.42, 271],
  ['2016-10-13T22:00:00.000Z', 31.18, 31.22, 30.37, 30.71, 30.17, 270],
  ['2016-10-16T22:00:00.000Z', 30.7, 31.86, 30.68, 31.72, 31.17, 344],
  ['2016-10-17T22:00:00.000Z', 32.1, 32.16, 31.51, 31.77, 31.21, 162],
  ['2016-10-18T22:00:00.000Z', 31.97, 32, 31.54, 31.73, 31.17, 159],
  ['2016-10-19T22:00:00.000Z', 31.47, 31.84, 31.4, 31.61, 31.13, 206],
  ['2016-10-20T22:00:00.000Z', 31.22, 31.59, 31.06, 31.53, 31.05, 299],
  ['2016-10-23T22:00:00.000Z', 31.7, 32.21, 31.57, 31.89, 31.41, 209],
  ['2016-10-24T22:00:00.000Z', 32.1, 32.45, 31.76, 31.92, 31.44, 223],
  ['2016-10-25T22:00:00.000Z', 31.74, 32.22, 31.67, 31.95, 31.47, 154],
  ['2016-10-26T22:00:00.000Z', 32, 32.12, 31.72, 31.99, 31.5, 318],
  ['2016-10-27T22:00:00.000Z', 31.95, 32.05, 31.72, 31.83, 31.35, 215],
  ['2016-10-30T23:00:00.000Z', 31.93, 32.17, 31.71, 32.17, 31.68, 177],
  ['2016-10-31T23:00:00.000Z', 32.4, 32.4, 31.73, 32, 31.51, 223],
  ['2016-11-01T23:00:00.000Z', 31.84, 32.16, 31.26, 31.29, 30.82, 192],
  ['2016-11-02T23:00:00.000Z', 31.3, 31.57, 31.07, 31.55, 31.07, 152],
  ['2016-11-03T23:00:00.000Z', 31.55, 32.14, 31.47, 31.89, 31.41, 171],
  ['2016-11-06T23:00:00.000Z', 32.54, 32.6, 32.22, 32.54, 32.05, 179],
  ['2016-11-07T23:00:00.000Z', 32.39, 32.7, 32.24, 32.43, 31.94, 138],
  ['2016-11-08T23:00:00.000Z', 32.25, 34.19, 32.25, 33.88, 33.37, 339],
  ['2016-11-09T23:00:00.000Z', 34.33, 34.76, 34.03, 34.46, 33.94, 306],
  ['2016-11-10T23:00:00.000Z', 34.35, 35.12, 34.35, 35.08, 34.55, 372],
  ['2016-11-13T23:00:00.000Z', 35.59, 36.67, 35.59, 36.01, 35.46, 328],
  ['2016-11-14T23:00:00.000Z', 35.97, 36.14, 35.48, 36.03, 35.48, 228],
  ['2016-11-15T23:00:00.000Z', 36.02, 36.63, 35.97, 36.63, 36.07, 195],
  ['2016-11-16T23:00:00.000Z', 36.63, 37.23, 36.63, 37.2, 36.64, 207],
  ['2016-11-17T23:00:00.000Z', 37.26, 37.9, 37, 37.68, 37.11, 265],
  ['2016-11-20T23:00:00.000Z', 37.85, 38.14, 37.38, 38.05, 37.47, 200],
  ['2016-11-21T23:00:00.000Z', 38.16, 38.75, 38.04, 38.67, 38.08, 339],
  ['2016-11-22T23:00:00.000Z', 38.75, 38.75, 37.65, 37.96, 37.38, 304],
  ['2016-11-24T23:00:00.000Z', 38.11, 38.11, 37.61, 37.96, 37.38, 104],
  ['2016-11-27T23:00:00.000Z', 37.68, 37.98, 37.49, 37.78, 37.21, 194],
  ['2016-11-28T23:00:00.000Z', 37.89, 37.96, 37.6, 37.65, 37.08, 201],
  ['2016-11-29T23:00:00.000Z', 37.86, 37.86, 36.86, 36.89, 36.33, 209],
  ['2016-11-30T23:00:00.000Z', 36.85, 37.33, 36.57, 36.98, 36.42, 222],
  ['2016-12-01T23:00:00.000Z', 37.01, 37.07, 36.65, 36.87, 36.31, 190],
  ['2016-12-04T23:00:00.000Z', 37.27, 37.42, 36.87, 37.14, 36.58, 269],
  ['2016-12-05T23:00:00.000Z', 37.45, 38.03, 37.2, 37.94, 37.36, 340],
  ['2016-12-06T23:00:00.000Z', 37.75, 38.17, 37.55, 38.04, 37.46, 301],
  ['2016-12-07T23:00:00.000Z', 38.07, 38.25, 37.65, 37.99, 37.41, 229],
  ['2016-12-08T23:00:00.000Z', 38.21, 38.53, 37.9, 38.31, 37.73, 202],
  ['2016-12-11T23:00:00.000Z', 38.27, 38.7, 36.88, 37.52, 36.95, 227],
  ['2016-12-12T23:00:00.000Z', 37.76, 38.02, 36.85, 36.98, 36.42, 121],
  ['2016-12-13T23:00:00.000Z', 36.79, 36.87, 36.03, 36.21, 35.66, 231],
  ['2016-12-14T23:00:00.000Z', 36.23, 37.55, 35.96, 37.15, 36.59, 233],
  ['2016-12-15T23:00:00.000Z', 37.22, 37.85, 36.94, 37.02, 36.46, 594],
  ['2016-12-18T23:00:00.000Z', 37.17, 37.65, 37.03, 37.49, 36.92, 155],
  ['2016-12-19T23:00:00.000Z', 37.8, 38.08, 37.22, 37.58, 37.01, 241],
  ['2016-12-20T23:00:00.000Z', 37.43, 37.78, 37.23, 37.56, 36.99, 185],
  ['2016-12-21T23:00:00.000Z', 36.25, 36.56, 33.76, 34.19, 33.67, 726],
  ['2016-12-28T23:00:00.000Z', 33.73, 33.9, 33.31, 33.52, 33.01, 196],
  ['2016-12-29T23:00:00.000Z', 33.58, 33.58, 32.92, 33.05, 32.55, 184],
  ['2017-01-02T23:00:00.000Z', 33.26, 33.66, 33.1, 33.25, 32.75, 204],
  ['2017-01-03T23:00:00.000Z', 33.49, 33.56, 33.17, 33.44, 32.93, 239],
  ['2017-01-04T23:00:00.000Z', 33.37, 33.47, 32.16, 32.27, 31.78, 277],
  ['2017-01-05T23:00:00.000Z', 32.46, 32.59, 32.13, 32.31, 31.82, 148],
  ['2017-01-08T23:00:00.000Z', 32.05, 32.24, 31.73, 31.98, 31.49, 148],
  ['2017-01-09T23:00:00.000Z', 31.84, 32.42, 31.84, 32.25, 31.76, 129],
  ['2017-01-10T23:00:00.000Z', 32.37, 32.5, 31.92, 32.31, 31.82, 162],
  ['2017-01-11T23:00:00.000Z', 32.28, 32.28, 31.2, 31.93, 31.45, 184],
  ['2017-01-12T23:00:00.000Z', 32.14, 32.37, 31.9, 32.28, 31.79, 216],
  ['2017-01-16T23:00:00.000Z', 31.99, 32.05, 31.26, 31.49, 31.01, 328],
  ['2017-01-17T23:00:00.000Z', 31.56, 31.93, 31.36, 31.93, 31.45, 178],
  ['2017-01-18T23:00:00.000Z', 32.42, 32.97, 31.71, 32.14, 31.73, 243],
  ['2017-01-19T23:00:00.000Z', 32.21, 32.35, 31.75, 32.03, 31.62, 149],
  ['2017-01-22T23:00:00.000Z', 32.02, 32.23, 31.44, 31.79, 31.38, 164],
  ['2017-01-23T23:00:00.000Z', 31.87, 32.45, 31.72, 32.36, 31.94, 127],
  ['2017-01-24T23:00:00.000Z', 32.5, 32.89, 32.13, 32.64, 32.22, 126],
  ['2017-01-25T23:00:00.000Z', 32.71, 33.11, 32.53, 32.56, 32.14, 128],
  ['2017-01-26T23:00:00.000Z', 32.57, 32.69, 32.23, 32.45, 32.03, 86],
  ['2017-01-29T23:00:00.000Z', 32.08, 32.21, 31.23, 31.74, 31.33, 135],
  ['2017-01-30T23:00:00.000Z', 31.54, 32.08, 31.25, 31.99, 31.58, 142],
  ['2017-01-31T23:00:00.000Z', 32.33, 32.76, 31.86, 32.05, 31.64, 100],
  ['2017-02-01T23:00:00.000Z', 31.9, 32.27, 31.73, 32.13, 31.72, 108],
  ['2017-02-02T23:00:00.000Z', 32.5, 33.05, 32.21, 32.98, 32.56, 101],
  ['2017-02-05T23:00:00.000Z', 33.12, 33.56, 32.93, 33.06, 32.64, 141],
  ['2017-02-06T23:00:00.000Z', 33.16, 33.36, 33.02, 33.04, 32.62, 119],
  ['2017-02-07T23:00:00.000Z', 32.83, 32.83, 31.89, 32.38, 31.96, 121],
  ['2017-02-08T23:00:00.000Z', 32.43, 33.28, 32.39, 33.03, 32.61, 101],
  ['2017-02-09T23:00:00.000Z', 33.24, 33.68, 32.99, 33.65, 33.22, 93],
  ['2017-02-12T23:00:00.000Z', 33.88, 34.15, 33.65, 33.78, 33.35, 109],
  ['2017-02-13T23:00:00.000Z', 33.61, 33.94, 33.26, 33.9, 33.46, 146],
  ['2017-02-14T23:00:00.000Z', 33.8, 34.33, 33.57, 34.3, 33.86, 163],
  ['2017-02-15T23:00:00.000Z', 34.3, 34.3, 33.59, 33.95, 33.51, 156],
  ['2017-02-16T23:00:00.000Z', 33.97, 34.07, 33.66, 33.98, 33.54, 140],
  ['2017-02-20T23:00:00.000Z', 34.06, 34.29, 33.81, 33.98, 33.54, 91],
  ['2017-02-21T23:00:00.000Z', 33.95, 34.24, 33.55, 33.99, 33.55, 112],
  ['2017-02-22T23:00:00.000Z', 34.02, 34.02, 33.25, 33.42, 32.99, 87],
  ['2017-02-23T23:00:00.000Z', 32.97, 33.8, 32.67, 33.68, 33.25, 125],
  ['2017-02-26T23:00:00.000Z', 33.82, 34.75, 33.66, 34.41, 33.97, 164],
  ['2017-02-27T23:00:00.000Z', 34.37, 34.69, 34.09, 34.42, 33.98, 174],
  ['2017-02-28T23:00:00.000Z', 35.08, 35.46, 34.79, 34.95, 34.5, 170],
  ['2017-03-01T23:00:00.000Z', 35, 35.05, 34.15, 34.26, 33.82, 136],
  ['2017-03-02T23:00:00.000Z', 34.34, 34.37, 33.94, 34.1, 33.66, 109],
  ['2017-03-05T23:00:00.000Z', 33.81, 34.15, 33.68, 33.97, 33.53, 76],
  ['2017-03-06T23:00:00.000Z', 33.84, 34.1, 33.52, 33.98, 33.54, 90],
  ['2017-03-07T23:00:00.000Z', 34.12, 34.16, 33.4, 33.43, 33, 74],
  ['2017-03-08T23:00:00.000Z', 33.39, 33.76, 32.91, 33.37, 32.94, 89],
  ['2017-03-09T23:00:00.000Z', 33.58, 33.6, 32.73, 32.92, 32.5, 147],
  ['2017-03-12T23:00:00.000Z', 32.92, 33.63, 32.9, 33.6, 33.17, 97],
  ['2017-03-13T23:00:00.000Z', 33.31, 33.46, 32.83, 33.29, 32.86, 85],
  ['2017-03-14T23:00:00.000Z', 33.35, 33.98, 33.34, 33.88, 33.44, 113],
  ['2017-03-15T23:00:00.000Z', 34, 34.13, 33.67, 33.83, 33.4, 102],
  ['2017-03-16T23:00:00.000Z', 33.78, 34.34, 33.7, 34.22, 33.78, 415],
  ['2017-03-19T23:00:00.000Z', 34.15, 34.42, 34.02, 34.11, 33.67, 115],
  ['2017-03-20T23:00:00.000Z', 34.12, 34.36, 31.97, 32.74, 32.32, 121],
  ['2017-03-21T23:00:00.000Z', 33.19, 34.4, 32.01, 34.29, 33.85, 278],
  ['2017-03-22T23:00:00.000Z', 34.28, 34.39, 33.69, 34.15, 33.71, 227],
  ['2017-03-23T23:00:00.000Z', 34.17, 34.6, 33.92, 34.02, 33.58, 262],
  ['2017-03-26T22:00:00.000Z', 33.59, 33.81, 32.6, 33.43, 33, 232],
  ['2017-03-27T22:00:00.000Z', 33.31, 34.44, 33.09, 34.39, 33.95, 183],
  ['2017-03-28T22:00:00.000Z', 34.3, 34.56, 33.77, 33.91, 33.47, 189],
  ['2017-03-29T22:00:00.000Z', 33.83, 33.92, 33.46, 33.78, 33.35, 122],
  ['2017-03-30T22:00:00.000Z', 33.85, 34.04, 33.58, 33.63, 33.2, 273],
  ['2017-04-02T22:00:00.000Z', 33.66, 34.53, 33, 34.2, 33.76, 256],
  ['2017-04-03T22:00:00.000Z', 34.1, 34.64, 34.1, 34.21, 33.77, 142],
  ['2017-04-04T22:00:00.000Z', 34.39, 34.76, 33.47, 33.5, 33.07, 110],
  ['2017-04-05T22:00:00.000Z', 33.23, 33.53, 32.96, 33.48, 33.05, 207],
  ['2017-04-06T22:00:00.000Z', 33.44, 33.74, 32.84, 33.61, 33.18, 193],
  ['2017-04-09T22:00:00.000Z', 33.66, 34.11, 33.37, 33.74, 33.31, 121],
  ['2017-04-10T22:00:00.000Z', 33.74, 34.38, 33.74, 34.24, 33.8, 174],
  ['2017-04-11T22:00:00.000Z', 34.26, 34.26, 33.33, 33.37, 32.94, 126],
  ['2017-04-12T22:00:00.000Z', 33.29, 33.52, 32.57, 33.01, 32.59, 139],
  ['2017-04-16T22:00:00.000Z', 33.13, 33.52, 33.08, 33.46, 33.03, 154],
  ['2017-04-17T22:00:00.000Z', 33.32, 33.65, 33.21, 33.62, 33.19, 178],
  ['2017-04-18T22:00:00.000Z', 33.8, 34.01, 33.69, 33.97, 33.53, 126],
  ['2017-04-19T22:00:00.000Z', 34.13, 34.52, 33.99, 34.49, 34.05, 256],
  ['2017-04-20T22:00:00.000Z', 34.49, 34.98, 34.41, 34.66, 34.21, 192],
  ['2017-04-23T22:00:00.000Z', 35.37, 35.56, 35.14, 35.46, 35, 134],
  ['2017-04-24T22:00:00.000Z', 35.7, 35.98, 35.66, 35.75, 35.29, 151],
  ['2017-04-25T22:00:00.000Z', 35.65, 36.13, 35.65, 35.97, 35.51, 249],
  ['2017-04-26T22:00:00.000Z', 35.85, 36.47, 35.79, 35.96, 35.57, 143],
  ['2017-04-27T22:00:00.000Z', 36.02, 36.26, 35.72, 35.99, 35.6, 156],
  ['2017-04-30T22:00:00.000Z', 36.06, 36.08, 35.39, 35.87, 35.48, 158],
  ['2017-05-01T22:00:00.000Z', 35.87, 36.27, 35.75, 36.01, 35.62, 189],
  ['2017-05-02T22:00:00.000Z', 35.79, 36.03, 35.44, 35.49, 35.11, 146],
  ['2017-05-03T22:00:00.000Z', 35.7, 35.74, 34.87, 35.19, 34.81, 88],
  ['2017-05-04T22:00:00.000Z', 35.29, 35.48, 34.87, 35.44, 35.06, 139],
  ['2017-05-07T22:00:00.000Z', 35.45, 35.84, 35.23, 35.59, 35.21, 74],
  ['2017-05-08T22:00:00.000Z', 35.63, 35.73, 35.28, 35.52, 35.14, 81],
  ['2017-05-09T22:00:00.000Z', 35.42, 35.89, 35.28, 35.37, 34.99, 116],
  ['2017-05-10T22:00:00.000Z', 35.23, 35.23, 34.63, 34.95, 34.57, 72],
  ['2017-05-11T22:00:00.000Z', 34.82, 35, 34.43, 34.51, 34.14, 81],
  ['2017-05-14T22:00:00.000Z', 34.02, 35.06, 33.92, 34.87, 34.49, 68],
  ['2017-05-15T22:00:00.000Z', 34.96, 35.31, 34.96, 35.24, 34.86, 110],
  ['2017-05-16T22:00:00.000Z', 35.24, 35.24, 33.54, 33.54, 33.18, 160],
  ['2017-05-17T22:00:00.000Z', 33.37, 33.64, 33.17, 33.33, 32.97, 296],
  ['2017-05-18T22:00:00.000Z', 33.49, 34.09, 33.48, 33.6, 33.24, 199],
  ['2017-05-30T22:00:00.000Z', 34.64, 34.96, 34.27, 34.94, 34.56, 121],
  ['2017-05-31T22:00:00.000Z', 35.04, 35.1, 34.76, 34.95, 34.57, 150],
  ['2017-06-01T22:00:00.000Z', 35.09, 36.3, 35.09, 36.13, 35.74, 261],
  ['2017-06-04T22:00:00.000Z', 36.24, 36.31, 35.37, 35.38, 35, 98],
  ['2017-06-05T22:00:00.000Z', 35.27, 35.38, 34.87, 35.04, 34.66, 106],
  ['2017-06-06T22:00:00.000Z', 35, 35.11, 34.6, 34.67, 34.3, 99],
  ['2017-06-07T22:00:00.000Z', 34.68, 35.3, 34.5, 35.2, 34.82, 129],
  ['2017-06-08T22:00:00.000Z', 35.4, 35.8, 35.32, 35.55, 35.17, 166],
  ['2017-06-11T22:00:00.000Z', 35.63, 35.77, 35.33, 35.33, 34.95, 108],
  ['2017-06-12T22:00:00.000Z', 35.45, 35.79, 35.24, 35.53, 35.15, 103],
  ['2017-06-13T22:00:00.000Z', 35.5, 35.56, 35.03, 35.44, 35.06, 131],
  ['2017-06-14T22:00:00.000Z', 35.09, 35.53, 35, 35.24, 34.86, 92],
  ['2017-06-15T22:00:00.000Z', 34.99, 35.51, 34.97, 35.18, 34.8, 352],
  ['2017-06-18T22:00:00.000Z', 35.45, 35.66, 35.26, 35.38, 35, 108],
  ['2017-06-19T22:00:00.000Z', 35.26, 35.4, 34.77, 34.77, 34.4, 63],
  ['2017-06-20T22:00:00.000Z', 34.87, 34.87, 33.99, 34, 33.63, 106],
  ['2017-06-21T22:00:00.000Z', 34.04, 34.47, 33.92, 34.36, 33.99, 136],
  ['2017-06-22T22:00:00.000Z', 34.41, 34.68, 34.24, 34.32, 33.95, 215],
  ['2017-06-25T22:00:00.000Z', 34.4, 34.52, 34.07, 34.4, 34.03, 71],
  ['2017-06-26T22:00:00.000Z', 34.38, 34.75, 34.12, 34.12, 33.75, 108],
  ['2017-06-27T22:00:00.000Z', 34.31, 34.77, 34.24, 34.69, 34.32, 162],
  ['2017-06-28T22:00:00.000Z', 34.75, 34.77, 33.92, 34.22, 33.85, 103],
  ['2017-06-29T22:00:00.000Z', 34.32, 35.12, 34.09, 34.76, 34.39, 177],
  ['2017-07-02T22:00:00.000Z', 34.97, 35.75, 34.94, 35.26, 34.88, 86],
  ['2017-07-04T22:00:00.000Z', 35.26, 35.45, 34.83, 35.3, 34.92, 189],
  ['2017-07-05T22:00:00.000Z', 34.98, 35.59, 34.7, 35.04, 34.66, 139],
  ['2017-07-06T22:00:00.000Z', 35.17, 35.53, 35.03, 35.46, 35.08, 153],
  ['2017-07-09T22:00:00.000Z', 35.46, 35.73, 35.2, 35.26, 34.88, 148],
  ['2017-07-10T22:00:00.000Z', 35.9, 37.16, 35.28, 36.65, 36.25, 698],
  ['2017-07-11T22:00:00.000Z', 37.13, 37.9, 35.8, 37.22, 36.82, 938],
  ['2017-07-12T22:00:00.000Z', 37.13, 37.64, 36.78, 37.64, 37.23, 357],
  ['2017-07-13T22:00:00.000Z', 37.65, 38.17, 37.56, 37.61, 37.2, 292],
  ['2017-07-16T22:00:00.000Z', 37.37, 37.73, 36.85, 36.9, 36.5, 284],
  ['2017-07-17T22:00:00.000Z', 36.77, 36.82, 36.25, 36.31, 35.92, 169],
  ['2017-07-18T22:00:00.000Z', 36.31, 36.78, 36.2, 36.75, 36.43, 214],
  ['2017-07-19T22:00:00.000Z', 36.61, 36.91, 36.51, 36.8, 36.48, 164],
  ['2017-07-20T22:00:00.000Z', 36.87, 36.9, 36.21, 36.49, 36.17, 208],
  ['2017-07-23T22:00:00.000Z', 36.26, 36.47, 36.11, 36.3, 35.98, 221],
  ['2017-07-24T22:00:00.000Z', 36.53, 36.73, 36.4, 36.65, 36.33, 147],
  ['2017-07-25T22:00:00.000Z', 36.75, 36.75, 36.25, 36.7, 36.38, 269],
  ['2017-07-26T22:00:00.000Z', 36.54, 36.6, 36.2, 36.34, 36.02, 179],
  ['2017-07-27T22:00:00.000Z', 36.15, 36.38, 36.12, 36.24, 35.92, 144],
  ['2017-07-30T22:00:00.000Z', 36.23, 37.46, 35.91, 37.4, 37.07, 621],
  ['2017-07-31T22:00:00.000Z', 37.45, 37.45, 36.52, 36.73, 36.41, 261],
  ['2017-08-01T22:00:00.000Z', 36.74, 37, 36.51, 36.85, 36.53, 239],
  ['2017-08-02T22:00:00.000Z', 36.92, 37.12, 36.74, 37, 36.68, 179],
  ['2017-08-03T22:00:00.000Z', 37.03, 37.13, 36.68, 36.84, 36.52, 136],
  ['2017-08-06T22:00:00.000Z', 36.95, 37.1, 36.59, 36.83, 36.51, 120],
  ['2017-08-07T22:00:00.000Z', 36.76, 37.11, 36.28, 36.38, 36.06, 178],
  ['2017-08-08T22:00:00.000Z', 36.29, 36.42, 36.03, 36.2, 35.88, 130],
  ['2017-08-09T22:00:00.000Z', 36, 36.43, 35.28, 35.29, 34.98, 148],
  ['2017-08-10T22:00:00.000Z', 35.01, 35.78, 34.8, 35.37, 35.06, 152],
  ['2017-08-13T22:00:00.000Z', 35.6, 36.37, 35.6, 36.37, 36.05, 79],
  ['2017-08-14T22:00:00.000Z', 36.42, 36.42, 35.78, 35.85, 35.54, 88],
  ['2017-08-15T22:00:00.000Z', 36.08, 36.14, 35.73, 35.91, 35.6, 83],
  ['2017-08-16T22:00:00.000Z', 35.77, 35.92, 35.17, 35.18, 34.87, 82],
  ['2017-08-17T22:00:00.000Z', 34.95, 35.49, 34.33, 35.23, 34.92, 84],
  ['2017-08-20T22:00:00.000Z', 35.17, 35.53, 35.07, 35.43, 35.12, 97],
  ['2017-08-21T22:00:00.000Z', 35.63, 35.89, 35.6, 35.71, 35.4, 61],
  ['2017-08-22T22:00:00.000Z', 35.5, 35.71, 35.12, 35.13, 34.82, 69],
  ['2017-08-23T22:00:00.000Z', 35.22, 35.49, 35.08, 35.31, 35, 42],
  ['2017-08-24T22:00:00.000Z', 35.51, 35.78, 35.3, 35.54, 35.23, 75],
  ['2017-08-27T22:00:00.000Z', 35.68, 35.75, 35.24, 35.36, 35.05, 98],
  ['2017-08-28T22:00:00.000Z', 35.13, 35.71, 35.02, 35.54, 35.23, 202],
  ['2017-08-29T22:00:00.000Z', 35.57, 36.17, 35.51, 36.05, 35.74, 147],
  ['2017-08-30T22:00:00.000Z', 36.25, 36.25, 35.74, 36.06, 35.74, 129],
  ['2017-08-31T22:00:00.000Z', 36.14, 36.29, 35.98, 36.25, 35.93, 180],
  ['2017-09-04T22:00:00.000Z', 36.14, 36.34, 35.73, 35.86, 35.55, 121],
  ['2017-09-05T22:00:00.000Z', 35.98, 35.98, 34.8, 35.07, 34.76, 193],
  ['2017-09-06T22:00:00.000Z', 35.16, 35.16, 34.27, 34.57, 34.27, 224],
  ['2017-09-07T22:00:00.000Z', 34.49, 34.97, 34.25, 34.54, 34.24, 114],
  ['2017-09-10T22:00:00.000Z', 34.88, 35.54, 34.88, 35.26, 34.95, 166],
  ['2017-09-11T22:00:00.000Z', 35.31, 35.58, 35.17, 35.41, 35.1, 211],
  ['2017-09-12T22:00:00.000Z', 35.32, 35.53, 35.14, 35.25, 34.94, 273],
  ['2017-09-13T22:00:00.000Z', 35.03, 35.55, 35.03, 35.35, 35.04, 387],
  ['2017-09-14T22:00:00.000Z', 35.25, 35.33, 34.93, 35.26, 34.95, 581],
  ['2017-09-17T22:00:00.000Z', 35.37, 36.74, 35.37, 36.55, 36.23, 293],
  ['2017-09-18T22:00:00.000Z', 36.66, 37.72, 36.45, 37.71, 37.38, 413],
  ['2017-09-19T22:00:00.000Z', 37.78, 39.31, 37.1, 38.88, 38.54, 486],
  ['2017-09-20T22:00:00.000Z', 38.74, 38.75, 37.55, 37.56, 37.23, 307],
  ['2017-09-21T22:00:00.000Z', 37.57, 37.67, 36.87, 36.94, 36.62, 333],
  ['2017-09-24T22:00:00.000Z', 36.99, 37.21, 36.84, 37.02, 36.7, 389],
  ['2017-09-25T22:00:00.000Z', 37.22, 37.22, 36.74, 36.98, 36.66, 160],
  ['2017-09-26T22:00:00.000Z', 37.28, 38.17, 37.14, 38.07, 37.74, 225],
  ['2017-09-27T22:00:00.000Z', 37.85, 38.09, 37.41, 37.78, 37.45, 212],
  ['2017-09-28T22:00:00.000Z', 37.83, 38.25, 37.73, 37.78, 37.45, 172],
  ['2017-10-01T22:00:00.000Z', 37.9, 38.61, 37.76, 38.55, 38.21, 323],
  ['2017-10-02T22:00:00.000Z', 38.6, 39.13, 38.3, 39.13, 38.79, 211],
  ['2017-10-03T22:00:00.000Z', 39.15, 39.34, 38.8, 39.18, 38.84, 126],
  ['2017-10-04T22:00:00.000Z', 39.22, 39.71, 38.98, 39.06, 38.72, 159],
  ['2017-10-05T22:00:00.000Z', 39.03, 39.17, 38.74, 38.85, 38.51, 117],
  ['2017-10-08T22:00:00.000Z', 39.07, 39.56, 38.78, 38.86, 38.52, 166],
  ['2017-10-09T22:00:00.000Z', 39.2, 39.2, 38.51, 38.7, 38.36, 312],
  ['2017-10-10T22:00:00.000Z', 38.6, 38.72, 37.78, 38.43, 38.09, 208],
  ['2017-10-11T22:00:00.000Z', 38.26, 38.73, 38.22, 38.59, 38.25, 185],
  ['2017-10-12T22:00:00.000Z', 38.72, 38.78, 38.4, 38.5, 38.16, 300],
  ['2017-10-15T22:00:00.000Z', 38.67, 38.8, 38.15, 38.39, 38.05, 103],
  ['2017-10-16T22:00:00.000Z', 38.27, 38.41, 38.11, 38.24, 37.91, 73],
  ['2017-10-17T22:00:00.000Z', 38.41, 38.72, 38.23, 38.61, 38.27, 96],
  ['2017-10-23T22:00:00.000Z', 38.78, 38.94, 38.49, 38.8, 38.54, 150],
  ['2017-10-24T22:00:00.000Z', 38.8, 39.03, 38.54, 38.7, 38.44, 107],
  ['2017-10-25T22:00:00.000Z', 38.91, 39.17, 38.47, 38.67, 38.41, 114],
  ['2017-10-26T22:00:00.000Z', 38.67, 38.95, 38.34, 38.61, 38.35, 114],
  ['2017-10-29T23:00:00.000Z', 38.44, 38.93, 38.03, 38.76, 38.5, 245],
  ['2017-10-30T23:00:00.000Z', 38.93, 39, 38.51, 38.89, 38.63, 174],
  ['2017-10-31T23:00:00.000Z', 39, 41.94, 39, 41.06, 40.78, 401],
  ['2017-11-01T23:00:00.000Z', 41.04, 41.49, 40.16, 41.32, 41.04, 252],
  ['2017-11-02T23:00:00.000Z', 41.48, 41.48, 40.37, 40.4, 40.13, 237],
  ['2017-11-05T23:00:00.000Z', 40.3, 40.58, 40.2, 40.41, 40.14, 138],
  ['2017-11-06T23:00:00.000Z', 40.34, 40.66, 39.96, 40.58, 40.3, 295],
  ['2017-11-07T23:00:00.000Z', 40.59, 40.99, 40.17, 40.62, 40.34, 221],
  ['2017-11-08T23:00:00.000Z', 40.52, 40.92, 40.24, 40.37, 40.1, 308],
  ['2017-11-09T23:00:00.000Z', 40.26, 40.42, 39.88, 40.11, 39.84, 169],
  ['2017-11-12T23:00:00.000Z', 39.86, 40.41, 39.7, 40.08, 39.81, 266],
  ['2017-11-13T23:00:00.000Z', 39.81, 40.03, 39.55, 39.93, 39.66, 153],
  ['2017-11-14T23:00:00.000Z', 39.74, 39.81, 39.3, 39.44, 39.17, 266],
  ['2017-11-15T23:00:00.000Z', 39.45, 40.17, 39.43, 39.97, 39.7, 147],
  ['2017-11-16T23:00:00.000Z', 39.75, 39.94, 39.41, 39.68, 39.41, 374],
  ['2017-11-19T23:00:00.000Z', 39.83, 40.13, 39.47, 39.99, 39.72, 218],
  ['2017-11-20T23:00:00.000Z', 40.21, 40.82, 40.21, 40.63, 40.35, 169],
  ['2017-11-21T23:00:00.000Z', 40.69, 40.91, 40.5, 40.59, 40.31, 78],
  ['2017-11-23T23:00:00.000Z', 40.63, 40.91, 40.38, 40.7, 40.42, 38],
  ['2017-11-26T23:00:00.000Z', 40.73, 41.01, 40.41, 40.78, 40.5, 238],
  ['2017-11-27T23:00:00.000Z', 40.93, 41.54, 40.62, 41.45, 41.17, 120],
  ['2017-11-28T23:00:00.000Z', 41.52, 41.76, 40.92, 41.37, 41.09, 103],
  ['2017-11-29T23:00:00.000Z', 41.55, 41.9, 41.24, 41.58, 41.3, 104],
  ['2017-11-30T23:00:00.000Z', 41.5, 41.5, 39.79, 41.16, 40.88, 195],
  ['2017-12-03T23:00:00.000Z', 42, 42.49, 41.55, 42.17, 41.88, 268],
  ['2017-12-04T23:00:00.000Z', 42.45, 42.57, 41.77, 42.19, 41.9, 225],
  ['2017-12-05T23:00:00.000Z', 42.17, 42.68, 42.04, 42.47, 42.18, 156],
  ['2017-12-06T23:00:00.000Z', 42.43, 42.82, 41.8, 42.7, 42.41, 193],
  ['2017-12-07T23:00:00.000Z', 42.77, 42.82, 42.29, 42.37, 42.08, 215],
  ['2017-12-10T23:00:00.000Z', 42.44, 42.44, 41.63, 41.75, 41.47, 179],
  ['2017-12-11T23:00:00.000Z', 41.99, 42.01, 41.6, 41.69, 41.41, 110],
  ['2017-12-12T23:00:00.000Z', 41.7, 42.1, 41.55, 41.66, 41.38, 161],
  ['2017-12-13T23:00:00.000Z', 41.73, 42.16, 41.14, 41.25, 40.97, 172],
  ['2017-12-14T23:00:00.000Z', 41.44, 42.87, 41.44, 42.66, 42.37, 462],
  ['2017-12-17T23:00:00.000Z', 42.93, 43.42, 42.74, 43.2, 42.91, 129],
  ['2017-12-18T23:00:00.000Z', 43.24, 43.44, 42.65, 42.78, 42.49, 160],
  ['2017-12-19T23:00:00.000Z', 42.97, 43.15, 42.74, 43.03, 42.74, 120],
  ['2017-12-20T23:00:00.000Z', 43.11, 44.04, 42.58, 43.95, 43.65, 324],
  ['2017-12-21T23:00:00.000Z', 40.95, 42.06, 39.14, 40.21, 39.94, 1],
  ['2017-12-25T23:00:00.000Z', 39.98, 40.71, 39.95, 40.15, 39.88, 409],
  ['2017-12-26T23:00:00.000Z', 40.33, 40.47, 39.41, 39.65, 39.38, 288],
  ['2017-12-27T23:00:00.000Z', 39.81, 39.89, 39.19, 39.59, 39.32, 323],
  ['2017-12-28T23:00:00.000Z', 39.73, 39.73, 39.06, 39.29, 39.02, 254],
  ['2018-01-01T23:00:00.000Z', 39.5, 39.72, 39.08, 39.45, 39.18, 471],
  ['2018-01-02T23:00:00.000Z', 39.38, 39.52, 39.03, 39.14, 38.87, 364],
  ['2018-01-03T23:00:00.000Z', 39.23, 39.45, 38.72, 38.75, 38.49, 333],
  ['2018-01-04T23:00:00.000Z', 38.83, 38.98, 38.56, 38.83, 38.57, 226],
  ['2018-01-07T23:00:00.000Z', 38.79, 39.3, 38.01, 39.18, 38.91, 237],
  ['2018-01-08T23:00:00.000Z', 39.25, 39.42, 38.71, 38.73, 38.47, 198],
  ['2018-01-09T23:00:00.000Z', 38.53, 38.67, 38.05, 38.52, 38.26, 194],
  ['2018-01-10T23:00:00.000Z', 38.53, 39.19, 38.28, 38.91, 38.65, 316],
  ['2018-01-11T23:00:00.000Z', 41.36, 42.76, 40.35, 41.73, 41.45, 394],
  ['2018-01-15T23:00:00.000Z', 42.51, 43.08, 40.75, 41.02, 40.74, 415],
  ['2018-01-16T23:00:00.000Z', 41.36, 41.4, 40.76, 41.15, 40.87, 258],
  ['2018-01-17T23:00:00.000Z', 41.18, 41.22, 40.81, 40.98, 40.7, 280],
  ['2018-01-18T23:00:00.000Z', 41.04, 41.86, 40.94, 41.8, 41.59, 223],
  ['2018-01-21T23:00:00.000Z', 41.61, 41.75, 40.98, 41.03, 40.83, 152],
  ['2018-01-22T23:00:00.000Z', 40.8, 41.07, 40.4, 40.44, 40.24, 197],
  ['2018-01-23T23:00:00.000Z', 40.4, 40.81, 40.4, 40.64, 40.44, 226],
  ['2018-01-24T23:00:00.000Z', 40.88, 41.06, 40.55, 40.63, 40.43, 149],
  ['2018-01-25T23:00:00.000Z', 40.74, 41, 40.43, 40.98, 40.78, 272],
  ['2018-01-28T23:00:00.000Z', 40.97, 41.5, 40.61, 40.62, 40.42, 191],
  ['2018-01-29T23:00:00.000Z', 40.41, 40.41, 39.88, 39.96, 39.76, 162],
  ['2018-01-30T23:00:00.000Z', 40.3, 40.55, 40.04, 40.47, 40.27, 394],
  ['2018-01-31T23:00:00.000Z', 40.36, 40.66, 39.61, 39.82, 39.62, 203],
  ['2018-02-01T23:00:00.000Z', 39.5, 39.63, 39.18, 39.22, 39.02, 245],
  ['2018-02-04T23:00:00.000Z', 39, 39.23, 36.96, 37.39, 37.2, 397],
  ['2018-02-05T23:00:00.000Z', 36.49, 38.1, 36.46, 38.1, 37.91, 536],
  ['2018-02-06T23:00:00.000Z', 38.03, 38.22, 37.5, 37.56, 37.37, 190],
  ['2018-02-07T23:00:00.000Z', 41.99, 42.36, 38.53, 38.54, 38.35, 764],
  ['2018-02-08T23:00:00.000Z', 38.89, 39.35, 38, 39.06, 38.87, 484],
  ['2018-02-11T23:00:00.000Z', 39.21, 39.93, 38.61, 39.74, 39.54, 262],
  ['2018-02-12T23:00:00.000Z', 39.48, 39.86, 39.13, 39.8, 39.6, 265],
  ['2018-02-13T23:00:00.000Z', 39.52, 40.95, 39.52, 40.85, 40.65, 252],
  ['2018-02-14T23:00:00.000Z', 41.16, 42.16, 40.97, 42.03, 41.82, 201],
  ['2018-02-15T23:00:00.000Z', 41.95, 42.92, 41.62, 42.5, 42.29, 588],
  ['2018-02-19T23:00:00.000Z', 42.27, 42.93, 42.18, 42.66, 42.45, 301],
  ['2018-02-20T23:00:00.000Z', 42.65, 44.14, 42.23, 43.4, 43.18, 243],
  ['2018-02-21T23:00:00.000Z', 43.66, 43.95, 43.15, 43.21, 42.99, 152],
  ['2018-02-22T23:00:00.000Z', 43.51, 43.84, 43.01, 43.62, 43.4, 128],
  ['2018-02-25T23:00:00.000Z', 43.71, 43.99, 43.39, 43.74, 43.52, 135],
  ['2018-02-26T23:00:00.000Z', 43.82, 44.25, 42.99, 43, 42.79, 209],
  ['2018-02-27T23:00:00.000Z', 43.26, 43.56, 42.58, 42.58, 42.37, 160],
  ['2018-02-28T23:00:00.000Z', 42.58, 42.86, 41.1, 41.41, 41.2, 199],
  ['2018-03-01T23:00:00.000Z', 41.15, 42.6, 40.87, 42.49, 42.28, 261],
  ['2018-03-04T23:00:00.000Z', 42.31, 42.75, 41.76, 42.53, 42.32, 112],
  ['2018-03-05T23:00:00.000Z', 42.71, 43.15, 42.02, 43.09, 42.88, 157],
  ['2018-03-06T23:00:00.000Z', 42.75, 43.5, 42.22, 43.4, 43.18, 122],
  ['2018-03-07T23:00:00.000Z', 43.61, 44.05, 43.09, 43.79, 43.57, 144],
  ['2018-03-08T23:00:00.000Z', 44.03, 44.98, 43.77, 44.9, 44.68, 270],
  ['2018-03-11T23:00:00.000Z', 45, 45.49, 44.63, 44.88, 44.66, 210],
  ['2018-03-12T23:00:00.000Z', 45.12, 45.6, 44.33, 44.39, 44.17, 163],
  ['2018-03-13T23:00:00.000Z', 44.67, 45.1, 43.44, 43.73, 43.51, 210],
  ['2018-03-14T23:00:00.000Z', 43.94, 44.16, 43.47, 43.58, 43.36, 196],
  ['2018-03-15T23:00:00.000Z', 43.56, 43.6, 42.81, 43.33, 43.11, 668],
  ['2018-03-26T22:00:00.000Z', 43.88, 44.8, 43.45, 44.03, 43.81, 377],
  ['2018-03-27T22:00:00.000Z', 44.03, 44.18, 43.16, 43.52, 43.3, 343],
  ['2018-03-28T22:00:00.000Z', 43.75, 44.68, 43.75, 44.11, 43.89, 261],
  ['2018-04-01T22:00:00.000Z', 43.94, 44.11, 42.09, 42.47, 42.26, 218],
  ['2018-04-02T22:00:00.000Z', 42.56, 42.9, 42.29, 42.59, 42.38, 334],
  ['2018-04-03T22:00:00.000Z', 42.07, 43.55, 42, 43.42, 43.2, 348],
  ['2018-04-04T22:00:00.000Z', 43.72, 44.19, 43.53, 44.07, 43.85, 297],
  ['2018-04-05T22:00:00.000Z', 43.75, 44.23, 42.99, 43.23, 43.01, 334],
  ['2018-04-08T22:00:00.000Z', 43.64, 43.68, 42.62, 42.69, 42.48, 156],
  ['2018-04-09T22:00:00.000Z', 43.24, 43.9, 42.82, 43.63, 43.41, 190],
  ['2018-04-10T22:00:00.000Z', 43.44, 44.48, 43.44, 43.8, 43.58, 157],
  ['2018-04-11T22:00:00.000Z', 43.91, 44.71, 43.91, 44.32, 44.1, 173],
  ['2018-04-12T22:00:00.000Z', 44.4, 44.65, 44.18, 44.53, 44.31, 177],
  ['2018-04-15T22:00:00.000Z', 44.6, 44.74, 43.2, 43.86, 43.64, 441],
  ['2018-04-16T22:00:00.000Z', 44.17, 45.49, 44.05, 44.72, 44.5, 266],
  ['2018-04-17T22:00:00.000Z', 45.02, 45.43, 44.5, 45.35, 45.12, 319],
  ['2018-04-18T22:00:00.000Z', 45.25, 45.91, 45.02, 45.45, 45.22, 162],
  ['2018-04-19T22:00:00.000Z', 45.35, 45.73, 44.81, 45, 44.78, 226],
  ['2018-04-22T22:00:00.000Z', 44.91, 45.28, 44.72, 44.87, 44.65, 299],
  ['2018-04-23T22:00:00.000Z', 45.05, 45.33, 43.91, 44.52, 44.3, 150],
  ['2018-04-24T22:00:00.000Z', 44.56, 45.11, 43.75, 44.35, 44.13, 140],
  ['2018-04-25T22:00:00.000Z', 44.55, 44.65, 43.99, 44.24, 44.02, 92],
  ['2018-04-26T22:00:00.000Z', 44.3, 44.3, 43.6, 43.98, 43.76, 103],
  ['2018-04-29T22:00:00.000Z', 44.03, 44.27, 43.29, 43.3, 43.16, 98],
  ['2018-04-30T22:00:00.000Z', 43.2, 43.56, 42.55, 43.47, 43.33, 223],
  ['2018-05-01T22:00:00.000Z', 43.48, 44.04, 43.34, 43.41, 43.27, 99],
  ['2018-05-02T22:00:00.000Z', 43.2, 43.71, 42.84, 43.52, 43.38, 118],
  ['2018-05-03T22:00:00.000Z', 43.41, 44.65, 43.3, 44.39, 44.24, 96],
  ['2018-05-06T22:00:00.000Z', 44.49, 45.49, 44.49, 45.32, 45.17, 223],
  ['2018-05-07T22:00:00.000Z', 44.97, 46.52, 44.97, 46.45, 46.3, 187],
  ['2018-05-08T22:00:00.000Z', 46.64, 47.36, 46.55, 47.11, 46.96, 163],
  ['2018-05-09T22:00:00.000Z', 47.27, 47.57, 46.41, 47.12, 46.97, 148],
  ['2018-05-10T22:00:00.000Z', 47.22, 47.22, 46.55, 46.81, 46.66, 134],
  ['2018-05-13T22:00:00.000Z', 46.89, 46.97, 46.17, 46.37, 46.22, 129],
  ['2018-05-14T22:00:00.000Z', 46.23, 46.84, 46.16, 46.43, 46.28, 89],
  ['2018-05-15T22:00:00.000Z', 46.64, 46.93, 46.34, 46.6, 46.45, 224],
  ['2018-05-16T22:00:00.000Z', 46.69, 47, 46.59, 46.71, 46.56, 167],
  ['2018-05-17T22:00:00.000Z', 46.9, 47.16, 46.67, 46.91, 46.76, 142],
  ['2018-05-20T22:00:00.000Z', 47.19, 47.97, 47.11, 47.7, 47.54, 142],
  ['2018-05-21T22:00:00.000Z', 46, 46.09, 42.93, 43.91, 43.77, 717],
  ['2018-05-22T22:00:00.000Z', 43.55, 44.55, 43.55, 44.36, 44.21, 191],
  ['2018-05-23T22:00:00.000Z', 44.21, 44.68, 44.16, 44.31, 44.16, 108],
  ['2018-05-24T22:00:00.000Z', 44.18, 44.44, 44.15, 44.31, 44.16, 75],
  ['2018-05-28T22:00:00.000Z', 43.99, 44.49, 43.77, 43.93, 43.79, 172],
  ['2018-05-29T22:00:00.000Z', 44.21, 45.43, 44.12, 45.22, 45.07, 142],
  ['2018-05-30T22:00:00.000Z', 45.16, 45.19, 44.52, 44.69, 44.54, 91],
  ['2018-05-31T22:00:00.000Z', 45.03, 45.62, 45.02, 45.32, 45.17, 122],
  ['2018-06-03T22:00:00.000Z', 45.47, 46.3, 45.47, 46.26, 46.11, 133],
  ['2018-06-04T22:00:00.000Z', 46.23, 47.57, 45.83, 47.27, 47.11, 384],
  ['2018-06-05T22:00:00.000Z', 47.19, 47.61, 46.71, 47.46, 47.3, 309],
  ['2018-06-06T22:00:00.000Z', 47.55, 47.67, 47.1, 47.51, 47.35, 398],
  ['2018-06-07T22:00:00.000Z', 47.41, 47.69, 47.16, 47.63, 47.47, 256],
  ['2018-06-10T22:00:00.000Z', 47.61, 47.81, 46.86, 47.77, 47.61, 178],
  ['2018-06-11T22:00:00.000Z', 47.9, 48.5, 47.8, 48.43, 48.27, 247],
  ['2018-06-12T22:00:00.000Z', 48.42, 48.78, 48.3, 48.65, 48.49, 258],
  ['2018-06-13T22:00:00.000Z', 48.81, 49.05, 47.52, 47.95, 47.79, 262],
  ['2018-06-14T22:00:00.000Z', 47.63, 47.63, 46.81, 47.3, 47.14, 453],
  ['2018-06-17T22:00:00.000Z', 47.12, 48.03, 46.89, 47.9, 47.74, 158],
  ['2018-06-18T22:00:00.000Z', 47.59, 47.85, 46.73, 47.32, 47.16, 184],
  ['2018-06-19T22:00:00.000Z', 47.61, 47.96, 47, 47.73, 47.57, 92],
  ['2018-06-20T22:00:00.000Z', 47.68, 47.78, 47.07, 47.34, 47.18, 109],
  ['2018-06-21T22:00:00.000Z', 47.54, 47.82, 47.2, 47.29, 47.13, 164],
  ['2018-06-24T22:00:00.000Z', 47.31, 47.48, 46.05, 46.4, 46.25, 156],
  ['2018-06-25T22:00:00.000Z', 46.33, 47.75, 46.33, 47.6, 47.44, 177],
  ['2018-06-26T22:00:00.000Z', 47.55, 48.28, 46.54, 46.55, 46.4, 196],
  ['2018-06-27T22:00:00.000Z', 46.53, 46.9, 45.97, 46.64, 46.49, 131],
  ['2018-06-28T22:00:00.000Z', 46.85, 47.18, 46.49, 46.49, 46.34, 235],
  ['2018-07-01T22:00:00.000Z', 46.3, 46.69, 45.9, 46.65, 46.5, 145],
  ['2018-07-02T22:00:00.000Z', 46.85, 47.47, 46.49, 46.54, 46.39, 74],
  ['2018-07-04T22:00:00.000Z', 46.9, 47.25, 46.28, 47.24, 47.09, 154],
  ['2018-07-05T22:00:00.000Z', 47.21, 47.85, 47, 47.2, 47.05, 134],
  ['2018-07-08T22:00:00.000Z', 47.48, 48.33, 47.33, 48.09, 47.93, 292],
  ['2018-07-09T22:00:00.000Z', 48.16, 48.99, 47.87, 48.55, 48.39, 646],
  ['2018-07-10T22:00:00.000Z', 45.27, 45.4, 42.41, 43.02, 42.88, 1],
  ['2018-07-11T22:00:00.000Z', 43.01, 44.33, 43.01, 43.65, 43.51, 453],
  ['2018-07-12T22:00:00.000Z', 43.65, 45.74, 43.65, 45.64, 45.49, 345],
  ['2018-07-15T22:00:00.000Z', 45.94, 46, 45.06, 45.3, 45.15, 218],
  ['2018-07-16T22:00:00.000Z', 45.51, 46.26, 45.36, 46.17, 46.02, 174],
  ['2018-07-17T22:00:00.000Z', 45.91, 47.15, 45.84, 46.83, 46.68, 263],
  ['2018-07-18T22:00:00.000Z', 46.55, 47.27, 46.48, 47.08, 47, 195],
  ['2018-07-19T22:00:00.000Z', 46.96, 47.29, 46.72, 46.75, 46.67, 141],
  ['2018-07-22T22:00:00.000Z', 46.57, 47.05, 46.31, 46.49, 46.41, 139],
  ['2018-07-23T22:00:00.000Z', 46.81, 47.05, 46.07, 46.4, 46.32, 95],
  ['2018-07-24T22:00:00.000Z', 46.3, 46.97, 46.03, 46.94, 46.86, 217],
  ['2018-07-25T22:00:00.000Z', 46.83, 47.99, 46.64, 47.57, 47.49, 202],
  ['2018-07-26T22:00:00.000Z', 47.84, 47.9, 47.28, 47.45, 47.37, 108],
  ['2018-07-29T22:00:00.000Z', 47.48, 47.68, 46.44, 46.54, 46.46, 197],
  ['2018-07-30T22:00:00.000Z', 46.87, 47.77, 46.62, 47.41, 47.33, 277],
  ['2018-07-31T22:00:00.000Z', 47.41, 47.55, 46.58, 46.91, 46.83, 144],
  ['2018-08-01T22:00:00.000Z', 46.54, 47, 46.43, 46.81, 46.73, 100],
  ['2018-08-02T22:00:00.000Z', 46.79, 46.92, 46.1, 46.41, 46.33, 141],
  ['2018-08-05T22:00:00.000Z', 46.4, 46.56, 46.19, 46.55, 46.47, 76],
  ['2018-08-06T22:00:00.000Z', 46.65, 47.39, 46.54, 46.59, 46.51, 142],
  ['2018-08-07T22:00:00.000Z', 46.6, 47.05, 46.29, 46.99, 46.91, 88],
  ['2018-08-08T22:00:00.000Z', 46.97, 47.34, 46.54, 46.62, 46.54, 105],
  ['2018-08-09T22:00:00.000Z', 46.48, 46.48, 45.91, 46.04, 45.96, 109],
  ['2018-08-12T22:00:00.000Z', 46.11, 46.52, 45.82, 45.96, 45.88, 88],
  ['2018-08-13T22:00:00.000Z', 46.04, 46.62, 45.85, 46.26, 46.18, 160],
  ['2018-08-20T22:00:00.000Z', 45.27, 46.23, 45.1, 45.99, 45.91, 136],
  ['2018-08-21T22:00:00.000Z', 45.93, 46.42, 45.73, 46.1, 46.02, 115],
  ['2018-08-22T22:00:00.000Z', 46, 46.16, 45.61, 45.77, 45.69, 58],
  ['2018-08-23T22:00:00.000Z', 45.87, 46.14, 45.61, 45.99, 45.91, 88],
  ['2018-08-26T22:00:00.000Z', 46.22, 47.04, 46.1, 46.63, 46.55, 214],
  ['2018-08-27T22:00:00.000Z', 46.68, 47.12, 46.64, 46.83, 46.75, 172],
  ['2018-08-28T22:00:00.000Z', 46.88, 46.88, 46.39, 46.6, 46.52, 175],
  ['2018-08-29T22:00:00.000Z', 46.56, 46.56, 45.72, 45.98, 45.9, 139],
  ['2018-08-30T22:00:00.000Z', 45.95, 46.72, 45.95, 46.67, 46.59, 131],
  ['2018-09-03T22:00:00.000Z', 46.66, 46.66, 45.81, 46.2, 46.12, 212],
  ['2018-09-04T22:00:00.000Z', 46.09, 46.09, 45.41, 46, 45.92, 122],
  ['2018-09-05T22:00:00.000Z', 46.17, 46.6, 46.17, 46.28, 46.2, 75],
  ['2018-09-06T22:00:00.000Z', 46.17, 46.4, 45.72, 46.09, 46.01, 67],
  ['2018-09-09T22:00:00.000Z', 46.34, 46.65, 45.88, 46, 45.92, 87],
  ['2018-09-10T22:00:00.000Z', 44, 44.9, 42.38, 42.87, 42.8, 312],
  ['2018-09-11T22:00:00.000Z', 42.51, 43.2, 42, 43.06, 42.99, 207],
  ['2018-09-12T22:00:00.000Z', 43.33, 44.15, 42.73, 42.75, 42.68, 181],
  ['2018-09-13T22:00:00.000Z', 42.86, 43.15, 42.48, 42.76, 42.69, 665],
  ['2018-09-16T22:00:00.000Z', 42.76, 43.92, 42.76, 43.1, 43.03, 682],
  ['2018-09-17T22:00:00.000Z', 43.2, 45.72, 43.2, 44.74, 44.66, 652],
  ['2018-09-18T22:00:00.000Z', 44.72, 45.3, 43.67, 43.78, 43.71, 305],
  ['2018-09-19T22:00:00.000Z', 44.16, 44.69, 43.73, 44.5, 44.43, 443],
  ['2018-09-20T22:00:00.000Z', 44.86, 45.39, 44.51, 44.91, 44.83, 623],
  ['2018-09-23T22:00:00.000Z', 44.91, 45.2, 44.33, 44.99, 44.91, 179],
  ['2018-09-24T22:00:00.000Z', 45.05, 46.12, 44.91, 46.03, 45.95, 358],
  ['2018-09-25T22:00:00.000Z', 48.09, 51.52, 46.8, 48.62, 48.54, 1],
  ['2018-09-26T22:00:00.000Z', 48.91, 48.91, 45.6, 46.19, 46.11, 377],
  ['2018-09-27T22:00:00.000Z', 46.67, 48.5, 46.33, 47.89, 47.81, 616],
  ['2018-09-30T22:00:00.000Z', 47.93, 48.04, 45.99, 46.22, 46.14, 303],
  ['2018-10-01T22:00:00.000Z', 46, 46.09, 45.14, 45.34, 45.26, 292],
  ['2018-10-02T22:00:00.000Z', 45.67, 47.23, 45.38, 47.06, 46.98, 248],
  ['2018-10-03T22:00:00.000Z', 47.17, 47.43, 46.35, 46.67, 46.59, 175],
  ['2018-10-04T22:00:00.000Z', 46.93, 46.93, 45.64, 46.26, 46.18, 188],
  ['2018-10-07T22:00:00.000Z', 46.22, 46.42, 45.69, 45.92, 45.84, 130],
  ['2018-10-08T22:00:00.000Z', 45.84, 46, 44.81, 45.62, 45.54, 261],
  ['2018-10-09T22:00:00.000Z', 45.78, 45.78, 43.85, 43.99, 43.92, 254],
  ['2018-10-10T22:00:00.000Z', 43.9, 44.47, 43.53, 43.63, 43.56, 266],
  ['2018-10-11T22:00:00.000Z', 44.61, 44.61, 42.89, 43.54, 43.47, 186],
  ['2018-10-14T22:00:00.000Z', 43.5, 44.65, 43.44, 44.18, 44.11, 206],
  ['2018-10-15T22:00:00.000Z', 44.74, 45.49, 43.86, 45.44, 45.36, 180],
  ['2018-10-16T22:00:00.000Z', 45.36, 45.51, 44.65, 45.28, 45.2, 110],
  ['2018-10-17T22:00:00.000Z', 45.16, 45.16, 44.11, 44.59, 44.51, 159],
  ['2018-10-18T22:00:00.000Z', 44.49, 44.69, 43.53, 43.98, 43.98, 171],
  ['2018-10-21T22:00:00.000Z', 44.07, 44.73, 43.64, 44.7, 44.7, 132],
  ['2018-10-22T22:00:00.000Z', 44.16, 45.42, 44.14, 45.28, 45.28, 366],
  ['2018-10-23T22:00:00.000Z', 45.47, 45.92, 44.2, 44.23, 44.23, 446],
  ['2018-10-24T22:00:00.000Z', 44.75, 45.96, 44.18, 45.44, 45.44, 236],
  ['2018-10-25T22:00:00.000Z', 44.91, 46.29, 44.73, 46, 46, 518],
  ['2018-10-28T23:00:00.000Z', 46.65, 46.93, 45.88, 46.25, 46.25, 839],
  ['2018-10-29T23:00:00.000Z', 46.19, 47.14, 45.51, 46.92, 46.92, 367],
  ['2018-10-30T23:00:00.000Z', 47.51, 48.23, 46.95, 47.58, 47.58, 349],
  ['2018-10-31T23:00:00.000Z', 47.81, 48.66, 47.71, 48.61, 48.61, 187],
  ['2018-11-01T23:00:00.000Z', 48.82, 49.64, 48.63, 48.88, 48.88, 158],
  ['2018-11-04T23:00:00.000Z', 49, 49.26, 47.55, 48.32, 48.32, 167],
  ['2018-11-05T23:00:00.000Z', 48.29, 49.19, 48.29, 49.02, 49.02, 134],
  ['2018-11-06T23:00:00.000Z', 49.31, 49.78, 48.72, 49.67, 49.67, 162],
  ['2018-11-07T23:00:00.000Z', 49.72, 49.92, 49.07, 49.74, 49.74, 76],
  ['2018-11-08T23:00:00.000Z', 49.7, 49.72, 48.6, 49, 49, 166],
  ['2018-11-11T23:00:00.000Z', 48.88, 48.9, 47.59, 47.61, 47.61, 157],
  ['2018-11-12T23:00:00.000Z', 47.5, 47.7, 46.25, 46.88, 46.88, 182],
  ['2018-11-13T23:00:00.000Z', 47.38, 47.73, 45.87, 45.88, 45.88, 144],
  ['2018-11-14T23:00:00.000Z', 45.62, 46.59, 45.18, 46.3, 46.3, 158],
  ['2018-11-15T23:00:00.000Z', 45.89, 46.27, 45.2, 45.61, 45.61, 222],
  ['2018-11-18T23:00:00.000Z', 45.64, 45.72, 43.56, 43.71, 43.71, 198],
  ['2018-11-19T23:00:00.000Z', 43.08, 43.17, 42.09, 42.49, 42.49, 151],
  ['2018-11-20T23:00:00.000Z', 42.91, 43.59, 42.56, 43.04, 43.04, 135],
  ['2018-11-22T23:00:00.000Z', 42.8, 43.35, 42.23, 42.77, 42.77, 59],
  ['2018-11-25T23:00:00.000Z', 43.08, 43.53, 42.55, 43.27, 43.27, 217],
  ['2018-11-26T23:00:00.000Z', 43.14, 43.14, 42.13, 42.42, 42.42, 132],
  ['2018-11-27T23:00:00.000Z', 42.58, 43.65, 42.29, 43.3, 43.3, 196],
  ['2018-11-28T23:00:00.000Z', 43.23, 43.32, 42.92, 43.06, 43.06, 214],
  ['2018-11-29T23:00:00.000Z', 43.08, 43.77, 43, 43.69, 43.69, 294],
  ['2018-12-02T23:00:00.000Z', 44.39, 44.86, 43.94, 44.62, 44.62, 185],
  ['2018-12-03T23:00:00.000Z', 44.39, 44.61, 41.75, 41.83, 41.83, 161],
  ['2018-12-05T23:00:00.000Z', 40.94, 41.42, 39.41, 41.42, 41.42, 254],
  ['2018-12-06T23:00:00.000Z', 41.49, 42.43, 40.75, 40.92, 40.92, 170],
  ['2018-12-09T23:00:00.000Z', 41.05, 41.75, 40.34, 40.85, 40.85, 304],
  ['2018-12-10T23:00:00.000Z', 41.34, 41.8, 40.3, 40.74, 40.74, 184],
  ['2018-12-11T23:00:00.000Z', 41.31, 42.8, 41.31, 41.98, 41.98, 239],
  ['2018-12-12T23:00:00.000Z', 42, 42.17, 41.07, 41.22, 41.22, 156],
  ['2018-12-13T23:00:00.000Z', 40.8, 41.34, 40.26, 40.69, 40.69, 194],
  ['2018-12-16T23:00:00.000Z', 40.65, 41.18, 39.54, 39.74, 39.74, 624],
  ['2018-12-17T23:00:00.000Z', 40.1, 42.57, 40.1, 42.36, 42.36, 423],
  ['2018-12-18T23:00:00.000Z', 41.5, 42.98, 38.17, 39.1, 39.1, 1],
  ['2018-12-19T23:00:00.000Z', 38.55, 39.01, 35.3, 35.51, 35.51, 893],
  ['2018-12-20T23:00:00.000Z', 35.52, 37.47, 35.35, 36.15, 36.15, 1],
  ['2018-12-23T23:00:00.000Z', 35.97, 36.04, 34.64, 34.76, 34.76, 201],
  ['2018-12-25T23:00:00.000Z', 35.01, 35.68, 33.94, 35.62, 35.62, 242],
  ['2018-12-26T23:00:00.000Z', 35.07, 36.98, 35.07, 36.93, 36.93, 300],
  ['2018-12-27T23:00:00.000Z', 37.12, 37.48, 36.11, 36.89, 36.89, 161],
  ['2018-12-30T23:00:00.000Z', 37.08, 37.57, 36.47, 37.34, 37.34, 414],
  ['2019-01-01T23:00:00.000Z', 36.7, 37.45, 36.49, 37.45, 37.45, 425],
  ['2019-01-02T23:00:00.000Z', 37.37, 37.63, 36.31, 36.64, 36.64, 302],
  ['2019-01-03T23:00:00.000Z', 37.2, 38.29, 37.1, 37.57, 37.57, 325],
  ['2019-01-06T23:00:00.000Z', 37.77, 38.23, 37.18, 38.05, 38.05, 189],
  ['2019-01-07T23:00:00.000Z', 38.67, 39.06, 38.36, 39.03, 39.03, 238],
  ['2019-01-08T23:00:00.000Z', 39.34, 39.35, 38.55, 38.96, 38.96, 242],
  ['2019-01-09T23:00:00.000Z', 38.83, 39.1, 38.39, 38.91, 38.91, 374],
  ['2019-01-10T23:00:00.000Z', 38.6, 39.2, 38.64, 39.12, 39.12, 158]
]

describe('testing segment tree class: ', () => {
  let FinSegmentTree = new SegmentTree(
    financialSeries,
    finNodeFactory,
    finNodeMerger,
    finNodeQuery,
    finNodeLeafUpdater
  )

  const getAvg = (arr: (string | number)[][], l: number = 0, r: number = arr.length) => {
    let avg = 0,
      i = 0
    for (i = l; i < r; i++) {
      avg += <number>arr[i][4]
    }
    return avg / (r - l)
  }
  const getSigma = (
    arr: (string | number)[][],
    mu: number,
    l: number = 0,
    r: number = arr.length
  ) => {
    let s = 0,
      i = 0
    for (i = l; i < r; i++) {
      s += Math.pow(<number>arr[i][4] - mu, 2)
    }

    return s / (r - l)
  }
  const getMaxInRange = (arr: (string | number)[][], l: number = 0, r: number = arr.length) => {
    let m: number = <number>arr[l][2],
      i = 0
    for (i = l; i < r; i++) {
      m = Math.max(m, <number>arr[i][2])
    }
    return m
  }

  /**@TODO make a generic function working on arr<T> */
  const walfordMeanVariance = (
    arr: (string | number)[][],
    l: number = 0,
    r: number = arr.length
  ) => {
    let m = 0,
      i = 0,
      s = 0,
      k = 0
    for (i = l; i < r; i++) {
      let oldM = m
      let x = <number>arr[i][4]
      k++
      m += (x - m) / k
      s += (x - m) * (x - oldM)
    }
    return { avg: m, sigma: s / (r - l) }
  }

  it('have all nodes with correct mean and variance', () => {
    let tree = FinSegmentTree.getTree()
    tree.forEach((N, i) => {
      if (N.right > N.left) {
        let wmv = walfordMeanVariance(financialSeries, N.left, N.right + 1)
        expect(Math.abs(N.avg - wmv.avg)).toBeLessThan(0.001)
        expect(Math.abs(N.sigma - wmv.sigma)).toBeLessThan(0.001)
      }
    })
  })

  it('have small range average correct', () => {
    let avg = getAvg(financialSeries, 0, 11)
    let res = FinSegmentTree.query(0, 10)
    let sigma = getSigma(financialSeries, avg, 0, 11)
    let m = getMaxInRange(financialSeries, 0, 11)
    expect(res.max).toEqual(m)
    expect(avg.toFixed(3)).toEqual(res.avg.toFixed(3))
    expect(sigma.toFixed(3)).toEqual(res.sigma.toFixed(3))
  })

  it('have medium range average correct', () => {
    let res = FinSegmentTree.query(23, 70)
    let m = getMaxInRange(financialSeries, 23, 71)
    let wmv = walfordMeanVariance(financialSeries, 23, 71)
    expect(res.max).toEqual(m)
    expect(wmv.avg.toFixed(3)).toEqual(res.avg.toFixed(3))
  })

  //@TODO to fix variance computation
  it('have full average correct', () => {
    let wmv = walfordMeanVariance(financialSeries)
    let res = FinSegmentTree.query(0, financialSeries.length - 1)
    let highs = financialSeries.map(
      (v): number => {
        return <number>v[2]
      }
    )
    expect(Math.max(...highs)).toEqual(res.max)
    expect(Math.abs(wmv.avg - res.avg)).toBeLessThan(0.001)
    expect(Math.abs(wmv.sigma - res.sigma)).toBeLessThan(0.001)
  })
})

describe('testing lazy update range', () => {
  let queries = [[3, 7, 8], [7, 13, 12], [1, 5, 6]]
  let segBase = new Array(16).fill(0)
  let addRange = (l: number, r: number, v: number) => {
    for (let i = l; i <= r; i++) segBase[i] += v
  }
  const SEG_LONG: segmentLazy[] = buildSegTreeIterative(segBase, nodeFactoryFnL, nodeMergerFnL)
  let l = queries.length
  for (let i = 0; i < l; i++) {
    updateRangeLazy(
      SEG_LONG,
      queries[i][2],
      1,
      queries[i][0],
      queries[i][1],
      nodeSegLazyRangeUpdater,
      nodeMergerFnL,
      lazyValuePropagator
    )
  }
  addRange(3, 7, 8)
  addRange(7, 13, 12)
  addRange(1, 5, 6)

  const reducer = (accumulator: number, currentValue: number) => accumulator + currentValue

  it('check max and sum on whole range', () => {
    let qres = iterativeQueryRange(SEG_LONG, 0, 15, nodeQueryMergerL)
    let qr = queryRange(SEG_LONG, 1, 0, 15, nodeQueryMergerL)

    expect(Math.max(...segBase)).toEqual(qres.max)
    expect(qr.max).toEqual(qres.max)
    expect(qr.sum).toEqual(qres.sum)
    expect(qr.sum).toEqual(segBase.reduce(reducer))
  })

  it('check max and sum sub ranges 12-15', () => {
    let qres = iterativeQueryRange(SEG_LONG, 12, 15, nodeQueryMergerL)
    let qr = queryRange(SEG_LONG, 1, 12, 15, nodeQueryMergerL)

    expect(Math.max(...segBase.slice(12, 16))).toEqual(qres.max)
    expect(qr.max).toEqual(qres.max)
    expect(qr.sum).toEqual(qres.sum)
    expect(qr.sum).toEqual(segBase.slice(12, 16).reduce(reducer))
  })

  it('check max and sum sub ranges 3-9', () => {
    let qres = iterativeQueryRange(SEG_LONG, 3, 9, nodeQueryMergerL)
    let qr = queryRange(SEG_LONG, 1, 3, 9, nodeQueryMergerL)

    expect(Math.max(...segBase.slice(3, 10))).toEqual(qres.max)
    expect(qr.max).toEqual(qres.max)
    expect(qr.sum).toEqual(qres.sum)
    expect(qr.sum).toEqual(segBase.slice(3, 10).reduce(reducer))
  })

  it('check max and sum on leaves', () => {
    let qres = iterativeQueryRange(SEG_LONG, 7, 7, nodeQueryMergerL)
    let qr = queryRange(SEG_LONG, 1, 7, 7, nodeQueryMergerL)

    expect(Math.max(...segBase.slice(7, 8))).toEqual(qres.max)
    expect(qr.max).toEqual(qres.max)
    expect(qr.sum).toEqual(qres.sum)
    expect(qr.sum).toEqual(segBase.slice(7, 8).reduce(reducer))
  })
})

describe('Edge Cases and Different Lengths', () => {
  it('builds and queries an empty segment tree (Iterative)', () => {
    const emptyArr: number[] = []
    const segIter = buildSegTreeIterative(emptyArr, nodeFactoryFn, nodeMergerFn)
    expect(segIter.length).toEqual(0)
    const res = iterativeQueryRange(segIter, 0, 0, nodeQueryMerger)
    expect(res.left).toEqual(-1)
    expect(res.right).toEqual(-1)
  })

  it('builds and queries an empty segment tree (Recursive)', () => {
    const emptyArr: number[] = []
    const segRec = buildSegmentTree(emptyArr, nodeFactoryFn, nodeMergerFn)
    expect(segRec.length).toEqual(0)
    const res = queryRange(segRec, 1, 0, 0, nodeQueryMerger)
    expect(res.left).toEqual(-1)
    expect(res.right).toEqual(-1)
  })

  it('builds and queries a single element segment tree', () => {
    const arr = [10]
    const segIter = buildSegTreeIterative(arr, nodeFactoryFn, nodeMergerFn)
    const segRec = buildSegmentTree(arr, nodeFactoryFn, nodeMergerFn)

    // Iterative array length should be 2*n = 2
    expect(segIter.length).toEqual(2)
    // Query full range
    const resIter = iterativeQueryRange(segIter, 0, 0, nodeQueryMerger)
    expect(resIter.sum).toEqual(10)
    expect(resIter.min).toEqual(10)
    expect(resIter.max).toEqual(10)

    const resRec = queryRange(segRec, 1, 0, 0, nodeQueryMerger)
    expect(resRec.sum).toEqual(10)
  })

  it('builds and queries a two element segment tree', () => {
    const arr = [10, 20]
    const segIter = buildSegTreeIterative(arr, nodeFactoryFn, nodeMergerFn)
    const segRec = buildSegmentTree(arr, nodeFactoryFn, nodeMergerFn)

    expect(segIter.length).toEqual(4)

    const resIterFull = iterativeQueryRange(segIter, 0, 1, nodeQueryMerger)
    expect(resIterFull.sum).toEqual(30)
    expect(resIterFull.min).toEqual(10)
    expect(resIterFull.max).toEqual(20)

    const resRecFull = queryRange(segRec, 1, 0, 1, nodeQueryMerger)
    expect(resRecFull.sum).toEqual(30)
  })

  it('builds and queries a three element segment tree (Odd length)', () => {
    const arr = [10, 20, 30]
    const segIter = buildSegTreeIterative(arr, nodeFactoryFn, nodeMergerFn)
    const segRec = buildSegmentTree(arr, nodeFactoryFn, nodeMergerFn)

    expect(segIter.length).toEqual(6)

    const resIterFull = iterativeQueryRange(segIter, 0, 2, nodeQueryMerger)
    expect(resIterFull.sum).toEqual(60)
    expect(resIterFull.max).toEqual(30)

    const resRecFull = queryRange(segRec, 1, 0, 2, nodeQueryMerger)
    expect(resRecFull.sum).toEqual(60)

    // Query partial
    const resIterPart = iterativeQueryRange(segIter, 0, 1, nodeQueryMerger)
    expect(resIterPart.sum).toEqual(30)
  })
})
/**
 let finSeg = new algorithmsts.segmentTree.SegmentTree(financialSeries,algorithmsts.segmentTree.finNodeFactory,algorithmsts.segmentTree.finNodeMerger,algorithmsts.segmentTree.finNodeQuery,algorithmsts.segmentTree.finNodeLeafUpdater)
 */
